#define rochcor2015_cxx
#include "rochcor2015.h"
#include "TLorentzVector.h"


const double rochcor2015::netabin[25] = {-2.4,-2.25,-2.1,-1.85,-1.6,-1.4,-1.2,-1.0,-0.8,-0.6,-0.4,-0.2,
					 0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.85,2.1,2.25,2.4};

const double rochcor2015::anetabin[13] = {0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.85,2.1,2.25,2.4};

//---------------------------------------------------------------------------------------------
  
const double rochcor2015::dcor_bf[16][24]={{-0.000240036,-0.000109775,-0.000137553,-0.000033388,-0.000016438,-0.000095227,0.000028833,0.000017588,-0.000014259,-0.000023791,0.000105084,-0.000040925,-0.000006533,-0.000020415,0.000050895,0.000002018,0.000105825,-0.000032907,-0.000061108,-0.000051956,-0.000139657,-0.000161485,-0.000044980,0.000092512},
{-0.000174365,-0.000022039,-0.000084663,-0.000065567,-0.000003017,-0.000012272,-0.000094959,-0.000037559,0.000018857,0.000017546,0.000010270,-0.000030470,0.000019692,0.000029821,-0.000020032,-0.000069851,-0.000057528,-0.000036808,0.000016191,-0.000073424,-0.000057711,-0.000143901,0.000031646,-0.000025057},
{-0.000312127,0.000149294,-0.000147746,-0.000059283,-0.000105384,-0.000115711,-0.000044325,-0.000052910,-0.000043479,0.000001833,0.000016334,-0.000034640,-0.000004061,-0.000015873,-0.000026553,-0.000025716,-0.000057350,0.000004914,-0.000110261,-0.000045283,0.000036528,-0.000109040,0.000027138,0.000057150},
{-0.000198710,-0.000105650,-0.000055788,-0.000142449,0.000002566,-0.000111042,-0.000036164,-0.000043004,-0.000039818,-0.000019448,-0.000008247,-0.000055797,0.000012385,-0.000096784,0.000001085,-0.000023484,-0.000019120,-0.000038457,-0.000016188,-0.000122327,-0.000076652,-0.000065615,0.000053032,-0.000144556},
{-0.000064407,-0.000116037,-0.000088949,-0.000090406,-0.000042788,-0.000078647,-0.000024869,-0.000022367,-0.000007738,-0.000033655,-0.000034383,-0.000037276,0.000062756,-0.000012238,-0.000033123,-0.000015404,-0.000056832,-0.000021594,-0.000019128,-0.000048867,-0.000122522,-0.000068513,-0.000017468,-0.000086755},
{-0.000225555,-0.000045538,-0.000114693,-0.000034976,-0.000116348,-0.000051061,-0.000092376,-0.000053983,-0.000024946,-0.000059699,-0.000113902,-0.000030575,-0.000049306,-0.000092600,-0.000059479,-0.000024494,-0.000047237,-0.000102845,-0.000035674,-0.000134132,-0.000099405,-0.000025275,-0.000144196,-0.000173586},
{-0.000202979,-0.000143843,-0.000055144,-0.000046621,-0.000166223,-0.000004230,-0.000046471,0.000002195,0.000058558,-0.000016601,-0.000018999,-0.000027154,-0.000096912,-0.000053257,0.000032183,-0.000087949,-0.000033039,-0.000082957,-0.000041714,-0.000151444,-0.000139706,-0.000154147,-0.000038369,-0.000124459},
{-0.000239315,-0.000127070,-0.000101478,-0.000040021,0.000009759,-0.000107051,-0.000009449,-0.000001336,0.000002204,0.000037344,-0.000004008,0.000005324,0.000024392,-0.000033768,-0.000113105,-0.000028413,-0.000007661,-0.000029585,-0.000045451,-0.000136412,-0.000113271,-0.000096413,-0.000076642,-0.000198334},
{-0.000201129,-0.000120323,-0.000108325,-0.000141559,-0.000107834,-0.000071632,-0.000048169,-0.000004830,0.000000997,0.000029230,-0.000011700,-0.000060566,-0.000034654,-0.000108016,-0.000060900,0.000000191,0.000086772,-0.000029949,-0.000073279,-0.000073626,-0.000147567,-0.000112622,-0.000150798,-0.000144000},
{-0.000134032,-0.000095815,-0.000031135,-0.000036292,-0.000060287,0.000034218,-0.000030198,-0.000019550,0.000002548,-0.000019788,-0.000005763,-0.000044005,0.000025413,-0.000007440,-0.000050459,-0.000026855,-0.000081311,0.000018741,-0.000043042,-0.000083697,-0.000054061,-0.000080365,-0.000061800,-0.000220079},
{-0.000073941,-0.000115536,-0.000124159,0.000036563,-0.000039976,-0.000014894,-0.000003001,-0.000012388,-0.000052375,0.000020989,0.000062292,0.000032678,-0.000015924,-0.000071044,-0.000046759,-0.000027065,0.000007485,-0.000149816,-0.000069068,-0.000061599,-0.000081687,-0.000114296,-0.000180565,-0.000093180},
{-0.000099685,-0.000061070,-0.000114424,-0.000130737,-0.000069493,-0.000010913,-0.000066701,0.000005569,-0.000025025,-0.000039746,0.000067878,-0.000011700,0.000098344,-0.000057539,-0.000018291,-0.000015801,0.000009986,-0.000032771,-0.000076583,-0.000090990,-0.000105337,-0.000172320,-0.000060479,-0.000285219},
{-0.000241319,-0.000275103,-0.000104672,-0.000084833,-0.000092469,-0.000077922,-0.000001829,-0.000015022,-0.000057613,0.000032494,0.000024148,0.000069030,0.000043957,-0.000023792,-0.000021620,-0.000066291,-0.000021152,-0.000067534,-0.000007846,0.000037875,-0.000033040,-0.000154025,-0.000145281,-0.000189023},
{-0.000113174,-0.000165277,-0.000094968,-0.000034138,-0.000105463,-0.000016386,-0.000034502,0.000051617,0.000089377,-0.000001587,0.000078253,-0.000035521,0.000022957,0.000046091,0.000035428,0.000027862,0.000065382,0.000019494,0.000053197,-0.000031521,0.000024467,-0.000124207,0.000001186,-0.000147090},
{-0.000059434,-0.000150095,-0.000083554,-0.000033693,-0.000125762,-0.000081478,-0.000028534,0.000023419,-0.000054245,-0.000018090,-0.000019525,0.000107470,-0.000012280,-0.000031225,0.000018972,-0.000030112,0.000016504,0.000000204,-0.000019166,-0.000068443,-0.000120799,-0.000065165,-0.000058529,-0.000121281},
{-0.000264572,-0.000160616,-0.000112703,-0.000053580,0.000015802,-0.000128030,-0.000093587,0.000018940,-0.000033979,-0.000060632,0.000030149,0.000038211,-0.000029305,-0.000018743,-0.000021175,-0.000053826,0.000103439,-0.000032287,-0.000035422,-0.000089956,-0.000093003,-0.000148488,-0.000078286,-0.000180543}};
const double rochcor2015::dcor_ma[16][24]={{0.001061255,0.000858979,0.000526289,0.000376815,0.000222310,0.000102213,-0.000010249,0.000029038,0.000036001,0.000108364,0.000033695,0.000087293,0.000074130,0.000003518,0.000022489,0.000008531,-0.000102715,-0.000091074,-0.000090794,0.000009452,0.000198161,0.000314002,0.000677326,0.000801670},
{0.001523396,0.000910626,0.000333672,0.000210143,0.000128675,0.000107036,0.000126504,0.000098702,0.000080551,0.000044794,0.000037689,-0.000023763,0.000026081,-0.000007026,-0.000085213,-0.000060718,-0.000041672,-0.000036137,0.000083001,0.000180042,0.000311411,0.000485344,0.000717358,0.001158202},
{0.001475523,0.000942291,0.000449948,0.000219655,0.000058722,0.000051400,0.000078231,0.000008654,0.000048106,0.000047738,-0.000024158,0.000027044,0.000027397,-0.000003639,-0.000027265,-0.000011042,-0.000002917,-0.000051756,0.000074122,0.000179994,0.000342193,0.000423117,0.000886966,0.001041086},
{0.000778244,0.000520149,0.000249254,0.000099900,0.000042050,0.000040524,0.000066934,0.000053864,0.000026946,0.000068714,0.000058825,0.000051796,0.000017573,-0.000000940,0.000009025,-0.000026186,-0.000033256,0.000030868,0.000124885,0.000214468,0.000169885,0.000179628,0.000201581,0.000104664},
{-0.000251730,-0.000078734,-0.000052687,-0.000099047,-0.000031523,0.000025481,0.000054520,0.000087533,0.000052269,0.000040871,0.000048000,-0.000040075,-0.000006340,0.000014088,-0.000016636,-0.000084242,0.000032287,-0.000032283,-0.000022044,0.000002817,0.000023600,-0.000123810,-0.000213188,-0.000145303},
{-0.000791338,-0.000572041,-0.000270584,-0.000077494,-0.000076174,-0.000098598,0.000103280,0.000096398,0.000098140,0.000082102,0.000078864,0.000017950,0.000049948,0.000008922,0.000001814,-0.000001729,-0.000100830,0.000001107,0.000007504,-0.000058661,-0.000146835,-0.000193153,-0.000243841,-0.000200579},
{-0.001043014,-0.000770712,-0.000572917,-0.000154351,-0.000052677,0.000016357,0.000113562,0.000121402,0.000051271,0.000066146,0.000066343,0.000035831,0.000029184,0.000001532,-0.000016484,-0.000001605,-0.000008920,-0.000025028,0.000036068,-0.000078167,-0.000051309,-0.000046212,-0.000050832,0.000234981},
{-0.001385869,-0.001125347,-0.000801432,-0.000306725,-0.000101335,0.000028188,0.000071813,0.000154232,0.000065552,0.000080086,0.000054426,0.000040965,0.000030639,0.000032976,0.000077900,0.000020982,-0.000014717,0.000122601,0.000060596,0.000027533,-0.000103598,-0.000024411,-0.000088380,0.000189714},
{-0.001344547,-0.000960112,-0.000613121,-0.000248813,-0.000001696,0.000082734,0.000197947,0.000086587,0.000068203,0.000075904,0.000082503,0.000075082,0.000068087,0.000111164,0.000090506,0.000095181,0.000109645,0.000161624,0.000220818,0.000185910,0.000083492,0.000249490,0.000488093,0.000984504},
{-0.001121908,-0.000711838,-0.000322057,-0.000172970,0.000003454,-0.000018080,0.000070257,0.000059558,-0.000006486,0.000032178,0.000030797,0.000099816,0.000064454,0.000060060,0.000105913,0.000076270,0.000101840,0.000201250,0.000205694,0.000153540,0.000237190,0.000198041,0.000410871,0.000629401},
{-0.001190638,-0.000926827,-0.000468019,-0.000188777,-0.000122611,-0.000020601,-0.000047537,0.000000782,0.000036648,0.000005862,-0.000024409,0.000064217,0.000025243,-0.000015936,0.000129680,0.000039932,0.000050775,0.000133327,0.000026116,0.000105763,0.000132149,0.000101554,0.000226921,0.000484118},
{-0.000938908,-0.000432521,-0.000258083,-0.000136676,-0.000049989,0.000040964,-0.000041866,-0.000013848,-0.000035577,0.000022530,0.000007767,0.000048629,-0.000010754,0.000067768,0.000026932,0.000024265,0.000050494,-0.000046386,0.000060776,0.000053926,-0.000039322,-0.000070517,-0.000013053,-0.000004037},
{-0.000221634,-0.000199036,-0.000022327,-0.000046039,-0.000110459,-0.000035406,-0.000052579,-0.000017579,-0.000059985,-0.000043851,0.000023966,-0.000037562,-0.000021446,-0.000079227,0.000035384,-0.000047107,-0.000031014,-0.000044569,-0.000028264,0.000006677,-0.000051147,-0.000076499,-0.000330003,-0.000517222},
{-0.000158897,-0.000028006,0.000072830,-0.000047721,-0.000079412,0.000024172,0.000062711,0.000065142,-0.000025380,-0.000068917,0.000001956,-0.000040337,0.000006780,-0.000042269,-0.000045837,-0.000070429,-0.000059108,-0.000152897,-0.000153364,-0.000086408,-0.000021131,-0.000113571,-0.000237225,-0.000289089},
{0.000069037,0.000312415,0.000150177,0.000089033,0.000016735,0.000020808,0.000016854,0.000053799,-0.000037851,-0.000022670,0.000016994,-0.000002234,-0.000038621,0.000014310,-0.000080723,-0.000081701,-0.000162018,-0.000095895,-0.000113496,-0.000168346,-0.000090275,-0.000136365,-0.000246799,-0.000153885},
{0.000525739,0.000519770,0.000239583,0.000213310,0.000128733,0.000135591,-0.000004331,0.000012766,0.000029773,0.000030255,0.000056267,-0.000001333,-0.000034814,-0.000034887,0.000017201,-0.000114051,-0.000116913,-0.000150367,-0.000177354,-0.000073717,0.000001456,0.000072900,0.000141475,0.000551489}};
const double rochcor2015::mcor_bf[16][24]={{-0.000173699,-0.000156698,-0.000044324,-0.000012274,-0.000001258,-0.000012522,0.000036684,0.000025829,0.000061375,0.000024037,0.000031828,0.000020223,0.000072780,0.000032593,0.000032533,0.000055675,0.000050232,0.000038770,-0.000027650,0.000012254,0.000008281,-0.000042606,-0.000066247,-0.000151927},
{-0.000066760,-0.000179133,-0.000041155,-0.000046144,0.000017849,0.000032462,0.000008173,0.000005034,0.000030584,0.000039606,0.000004078,0.000031677,0.000029716,0.000058506,0.000063640,0.000025218,0.000044728,-0.000038817,0.000012947,0.000008234,-0.000007078,-0.000045670,-0.000107455,-0.000018633},
{-0.000199015,-0.000032932,-0.000027804,-0.000023378,-0.000036595,-0.000001574,0.000008899,0.000013096,0.000053059,0.000003219,0.000030370,0.000046891,0.000055145,0.000055546,0.000062812,0.000069670,0.000019783,0.000018087,-0.000011444,0.000003411,0.000016985,-0.000058105,0.000007911,0.000044109},
{-0.000070139,-0.000108813,-0.000034717,-0.000015402,0.000047956,-0.000070693,0.000012254,0.000038237,0.000046596,0.000014913,0.000028568,0.000058594,0.000072958,0.000036975,0.000040702,0.000033952,0.000039234,0.000053799,0.000066549,-0.000020285,-0.000056641,-0.000004517,0.000057667,-0.000077379},
{-0.000100029,-0.000097216,-0.000037835,-0.000056336,0.000000266,-0.000031912,0.000000599,0.000012023,0.000050763,-0.000004833,0.000044107,0.000048237,0.000079718,0.000043722,0.000036889,0.000008144,0.000014282,0.000046049,0.000005134,0.000009093,0.000014678,0.000065572,-0.000063535,-0.000167501},
{-0.000209016,-0.000057690,-0.000077291,-0.000007243,-0.000056446,0.000016827,-0.000013402,-0.000001719,0.000043930,0.000011529,0.000000170,0.000028086,0.000071755,0.000048092,0.000063752,0.000015676,-0.000003921,0.000063135,0.000007979,-0.000034380,-0.000004727,0.000013543,0.000030848,-0.000148101},
{-0.000127267,-0.000105502,-0.000043120,-0.000013093,-0.000017227,0.000017772,-0.000013292,0.000023072,0.000064264,0.000017392,0.000008479,0.000010118,0.000088257,0.000000940,0.000042846,0.000025107,0.000010554,0.000041066,-0.000001514,-0.000001781,-0.000007567,0.000043640,0.000001569,-0.000138625},
{-0.000119739,0.000054546,-0.000007358,0.000023563,0.000070915,0.000017495,0.000020827,0.000043883,0.000045560,0.000049208,0.000017078,0.000039192,0.000057589,0.000065984,0.000030224,0.000026495,0.000034733,0.000050378,0.000006780,-0.000073443,0.000013327,-0.000055834,-0.000139433,-0.000187624},
{-0.000181406,0.000073867,-0.000006260,-0.000013601,0.000024056,-0.000001916,0.000020590,0.000070090,0.000032900,0.000081713,0.000046666,0.000046799,0.000061903,0.000043013,0.000038484,0.000043978,0.000044885,0.000008686,0.000038780,-0.000009007,-0.000032043,-0.000031362,-0.000000251,-0.000087093},
{-0.000112385,-0.000027371,0.000012110,-0.000005956,0.000062481,-0.000032319,0.000032419,0.000056333,0.000045610,0.000041574,0.000054472,0.000027717,0.000064632,0.000050244,0.000052543,0.000051979,0.000012247,0.000090816,-0.000024623,0.000005779,-0.000035204,0.000005412,0.000041006,-0.000056804},
{-0.000254915,-0.000053245,-0.000027849,-0.000020128,-0.000009513,-0.000027978,0.000048666,0.000030289,0.000035597,0.000023339,0.000038915,0.000020307,0.000017875,0.000002861,0.000029551,0.000037342,0.000029669,-0.000023073,-0.000000513,-0.000062108,-0.000057398,-0.000030075,-0.000170179,-0.000204296},
{-0.000108649,-0.000082503,0.000016148,-0.000016616,0.000072976,0.000025201,-0.000030215,0.000015338,0.000045318,0.000011048,0.000069906,0.000061174,0.000059912,0.000035067,0.000051382,0.000009184,0.000052935,0.000043409,0.000008119,-0.000025266,-0.000033422,-0.000012392,-0.000022873,-0.000231039},
{-0.000109978,-0.000039251,-0.000000136,-0.000003801,0.000035587,-0.000001768,-0.000020029,0.000021269,0.000024748,0.000034691,0.000065105,0.000095165,0.000033584,0.000069028,0.000065276,-0.000027034,0.000016772,0.000024606,0.000049696,0.000046583,0.000027973,-0.000050195,-0.000051112,-0.000088954},
{-0.000088392,0.000024162,-0.000063935,0.000040174,0.000027983,0.000014005,0.000006486,0.000033330,0.000016823,0.000006271,0.000056320,0.000027361,0.000060532,0.000042903,0.000015678,0.000025638,0.000057396,0.000052386,0.000028739,-0.000045854,0.000007688,-0.000081094,-0.000044676,-0.000202938},
{0.000067517,-0.000022688,-0.000050852,0.000059749,0.000000525,-0.000073848,0.000046377,0.000012593,0.000056395,0.000031544,0.000049896,0.000069624,0.000061505,0.000039307,0.000082590,0.000030127,0.000046291,0.000062290,0.000013940,-0.000029874,0.000004827,-0.000043378,-0.000040836,-0.000162933},
{-0.000079626,-0.000059848,-0.000053836,-0.000014772,-0.000022961,0.000003404,-0.000053112,0.000029953,0.000050163,0.000026123,0.000041924,0.000036846,0.000062646,0.000073829,0.000108579,0.000033015,0.000018789,0.000014162,0.000012954,-0.000081774,0.000003301,0.000037548,0.000030964,-0.000136489}};
const double rochcor2015::mcor_ma[16][24]={{-0.000230662,-0.000014223,-0.000049321,-0.000017079,0.000022141,0.000014154,0.000007170,-0.000022615,-0.000024102,-0.000009129,-0.000026937,-0.000025436,-0.000044645,-0.000016289,-0.000018643,-0.000018766,-0.000025990,-0.000002430,0.000016709,-0.000009195,0.000015748,-0.000055793,-0.000022875,0.000038542},
{0.000032427,0.000055165,-0.000027229,0.000015625,-0.000009731,0.000015044,-0.000034525,0.000005833,-0.000016539,-0.000003750,-0.000018129,-0.000012578,-0.000043182,0.000001681,-0.000043593,-0.000057020,-0.000042760,0.000016915,-0.000021122,-0.000015931,0.000049096,0.000053036,0.000031558,-0.000047289},
{0.000025448,0.000020011,0.000018345,-0.000012943,-0.000067596,-0.000066790,-0.000015367,-0.000012351,-0.000022306,-0.000022722,-0.000016016,-0.000029338,0.000015892,-0.000038712,-0.000032728,-0.000014946,0.000022107,-0.000003857,0.000042350,-0.000003320,0.000081674,0.000055063,0.000076007,0.000222999},
{-0.000036843,-0.000081017,-0.000032888,0.000014311,-0.000005355,-0.000011415,-0.000047458,-0.000009839,-0.000015113,-0.000004678,0.000019089,0.000025365,0.000013134,0.000007495,-0.000032769,0.000000370,-0.000009323,-0.000029126,0.000022481,0.000015723,0.000024322,-0.000001390,0.000056028,0.000011559},
{0.000051035,-0.000020415,-0.000034156,0.000004718,0.000044235,0.000013796,-0.000022024,0.000029971,0.000012729,0.000028387,0.000005237,-0.000004304,0.000015747,0.000040267,0.000017143,-0.000003889,-0.000009349,0.000059768,0.000051015,0.000064048,0.000047106,0.000064558,0.000037082,0.000026022},
{0.000108597,-0.000031423,0.000047005,0.000017601,-0.000012704,0.000021839,0.000034332,-0.000001978,0.000040416,0.000040077,0.000019428,0.000009202,0.000056715,0.000038287,0.000075620,0.000017968,0.000006564,-0.000005967,0.000010217,0.000076004,0.000028438,0.000006581,-0.000025612,-0.000069249},
{0.000220389,-0.000035677,0.000030288,0.000005900,0.000096715,0.000041786,0.000031122,-0.000014112,0.000007527,-0.000007521,0.000035947,0.000009394,0.000038838,0.000062817,0.000041629,0.000021335,0.000023631,0.000012902,0.000023730,-0.000039170,-0.000012905,-0.000060823,0.000067030,-0.000079142},
{0.000073564,0.000101002,0.000092418,0.000075272,-0.000001548,0.000005643,-0.000015965,0.000014347,0.000026694,0.000009886,0.000035891,0.000002320,0.000022350,0.000031657,0.000021933,0.000003591,0.000013859,0.000050190,-0.000002336,-0.000027215,-0.000013526,-0.000001062,-0.000079107,0.000003741},
{0.000084405,0.000144652,0.000029899,0.000030011,0.000020990,0.000060852,-0.000041406,0.000095982,0.000046119,0.000042388,0.000032263,-0.000003293,-0.000000455,0.000050857,0.000020115,0.000010734,0.000032166,0.000044898,0.000035784,0.000120641,-0.000021502,0.000072426,0.000016026,0.000028443},
{0.000051336,0.000058746,0.000101469,-0.000013192,0.000034248,0.000022289,-0.000023746,0.000029993,0.000009213,0.000047650,0.000024964,0.000028281,0.000003115,0.000001776,-0.000002521,0.000005250,0.000065194,0.000053463,0.000080074,0.000035163,0.000065549,0.000131287,0.000162608,0.000142320},
{-0.000049399,0.000031913,0.000013707,-0.000012284,-0.000049188,-0.000017606,0.000015837,-0.000009469,0.000026863,0.000024285,0.000007907,0.000022522,-0.000004095,-0.000025970,0.000026338,-0.000006474,0.000029304,-0.000015595,0.000004047,0.000034713,0.000087403,0.000045030,0.000132509,0.000111874},
{-0.000125714,0.000037210,0.000000484,-0.000005175,0.000037382,-0.000000283,0.000004816,-0.000000332,-0.000013935,0.000007299,-0.000003555,-0.000001869,-0.000029777,0.000054643,0.000032543,0.000027737,0.000027261,0.000014421,0.000003773,0.000039003,0.000042037,0.000023537,0.000079806,0.000047144},
{0.000147513,-0.000003034,0.000035301,0.000052420,-0.000024339,0.000050886,-0.000022080,0.000014916,0.000021678,0.000011946,0.000018080,0.000006183,0.000014028,-0.000019632,-0.000018005,0.000032081,0.000008543,0.000000039,0.000039010,0.000020894,-0.000017422,-0.000034050,0.000062245,0.000043967},
{0.000006857,0.000017990,0.000077146,-0.000063126,-0.000007819,0.000005207,0.000014405,0.000019992,-0.000001615,-0.000015393,-0.000025953,-0.000004712,-0.000011971,-0.000011357,-0.000051319,0.000003364,0.000012274,-0.000013806,-0.000060716,-0.000000609,0.000007951,-0.000015612,-0.000039188,0.000024505},
{-0.000042032,0.000015805,-0.000000491,-0.000056637,-0.000009823,-0.000029357,-0.000034491,-0.000033052,-0.000026153,-0.000011537,-0.000006344,-0.000020999,-0.000000472,-0.000035543,-0.000030404,-0.000028774,-0.000017040,0.000002547,0.000004138,-0.000079049,0.000017304,0.000018585,-0.000147887,-0.000093768},
{0.000069772,0.000080280,0.000018539,0.000046186,-0.000013842,0.000021634,-0.000007963,-0.000028387,-0.000020949,-0.000023507,-0.000043830,-0.000022340,-0.000033640,-0.000006016,0.000010018,-0.000044631,-0.000052319,-0.000028845,-0.000022371,-0.000020147,-0.000007771,-0.000080290,-0.000145907,-0.000019289}};
//==========================================================================================================================
const double rochcor2015::dmavg[16][24]={{0.025253377,0.025148316,0.025252952,0.024676606,0.024652199,0.024629862,0.024635968,0.024928300,0.025045628,0.025200004,0.025141142,0.025530922,0.025461098,0.025098085,0.024849628,0.024856211,0.024741613,0.024781085,0.024929859,0.024840049,0.024730889,0.024987157,0.025445179,0.025464426},
{0.025615960,0.025283363,0.025111799,0.024802415,0.024601737,0.024478438,0.024719279,0.024447550,0.024819542,0.024980327,0.025128095,0.025301600,0.025116964,0.025215082,0.025228433,0.024944477,0.024957640,0.024642845,0.024490965,0.024779068,0.024710393,0.025193670,0.025417553,0.025641343},
{0.025617930,0.024715310,0.024727345,0.024744077,0.024370931,0.024894904,0.024665228,0.024971841,0.024903709,0.025041664,0.025334573,0.025216732,0.025451148,0.025541592,0.025247081,0.024811663,0.024685370,0.024719277,0.024702438,0.024704962,0.024795351,0.024966166,0.025042799,0.025717698},
{0.025499882,0.025195982,0.024731371,0.024780790,0.024635809,0.024653377,0.024619664,0.024756393,0.024882254,0.024988748,0.025086255,0.025418678,0.025502232,0.025195959,0.025057382,0.024917264,0.024783179,0.024875442,0.024460511,0.024847388,0.024874266,0.025106168,0.025328401,0.025444880},
{0.025223751,0.025442301,0.024791129,0.024819790,0.024528856,0.024623418,0.024730402,0.024872776,0.024942155,0.025273724,0.025145834,0.025374972,0.025260872,0.025200549,0.025156203,0.025168620,0.024766049,0.024644140,0.024755817,0.024650276,0.024770618,0.024840916,0.025168814,0.025375247},
{0.025486261,0.025242568,0.024955231,0.024858910,0.024673115,0.024735034,0.024630638,0.024788879,0.024843037,0.025090758,0.025238067,0.025392425,0.025340740,0.025354514,0.025146339,0.024886212,0.024745531,0.024610832,0.024620698,0.024531337,0.024690245,0.025002975,0.025517910,0.025631319},
{0.025162179,0.025360556,0.024958732,0.024882361,0.024685035,0.024626343,0.024584255,0.024635111,0.024863519,0.025109827,0.025019786,0.025420435,0.025170650,0.025379183,0.024796480,0.024946764,0.024692387,0.024886224,0.024810124,0.024639444,0.024946880,0.025066415,0.025407624,0.025545597},
{0.025862944,0.025365898,0.025006832,0.024898636,0.024683592,0.024793795,0.024567239,0.024633678,0.024730698,0.025101946,0.025191729,0.025249422,0.025412167,0.025266726,0.025199454,0.024993353,0.024829500,0.024612516,0.024503912,0.024624190,0.024855695,0.025130511,0.025712925,0.025176088},
{0.025566916,0.025543504,0.024969022,0.025026078,0.024724232,0.024640880,0.024609271,0.024940948,0.025007975,0.025018917,0.025211653,0.025283397,0.025545779,0.025349708,0.025110628,0.024981524,0.024627541,0.024735116,0.024566726,0.024651557,0.024808970,0.025008620,0.024968516,0.025726469},
{0.025724022,0.025189428,0.025054704,0.024924313,0.024536098,0.024541611,0.024502086,0.024860827,0.025055434,0.025108255,0.025127847,0.025284108,0.025426367,0.025338677,0.025094017,0.024821979,0.024620451,0.024830819,0.024562843,0.024575851,0.024844324,0.025205527,0.025219769,0.025571302},
{0.025580725,0.025306103,0.025384217,0.024830760,0.024737972,0.024907610,0.024677376,0.024922815,0.024940823,0.025118946,0.025327646,0.025373861,0.025110849,0.025081361,0.025141767,0.024792186,0.024605940,0.024824119,0.024664061,0.024479049,0.024781573,0.025035973,0.025464491,0.025427304},
{0.025268569,0.024956561,0.025217541,0.024901927,0.024645368,0.024611691,0.024687790,0.024837727,0.025072037,0.025054109,0.025176012,0.025580352,0.025170641,0.025057960,0.025248113,0.025071306,0.024838833,0.024749549,0.024587542,0.024722917,0.024869505,0.025110514,0.025265276,0.025425355},
{0.025732123,0.025261676,0.024923259,0.024807805,0.024739621,0.024587045,0.024638905,0.024825975,0.025080198,0.025096405,0.025204382,0.025247721,0.025261972,0.025314036,0.024945388,0.024780177,0.024796336,0.024613647,0.024713355,0.025053623,0.024829179,0.025167496,0.025414853,0.025406733},
{0.025596125,0.025173081,0.025041667,0.024904181,0.024587795,0.024828531,0.024645069,0.024609945,0.024734578,0.025028109,0.025334965,0.025297861,0.025432340,0.025221498,0.025085078,0.024800101,0.024724893,0.024591843,0.024900020,0.024808256,0.024705587,0.025191070,0.025491125,0.025581364},
{0.025673706,0.025283511,0.025009814,0.024797625,0.024764698,0.024683809,0.024644968,0.024765374,0.025067481,0.024927294,0.025260376,0.025236032,0.025327252,0.025316620,0.024943058,0.024634905,0.024668526,0.024904736,0.024762715,0.024734222,0.024759218,0.025066409,0.025691480,0.025505459},
{0.025475502,0.025169783,0.025049391,0.024581136,0.024898868,0.024743078,0.024747850,0.024707882,0.024929386,0.025035125,0.025311440,0.025271500,0.025220052,0.025454965,0.025218690,0.024837505,0.024919352,0.024808960,0.024566653,0.024675260,0.024771635,0.025213932,0.025378331,0.025602999}};
const double rochcor2015::dpavg[16][24]={{0.025809693,0.025110000,0.025366039,0.024915752,0.024662031,0.024640976,0.024669527,0.024751179,0.025084964,0.025201581,0.025259510,0.025464984,0.025495502,0.025423517,0.024948496,0.024948866,0.024802165,0.024827658,0.024608498,0.024752401,0.024827486,0.025041929,0.025283714,0.025461355},
{0.025925932,0.025171226,0.025202793,0.024585810,0.024721072,0.024605223,0.024831393,0.024800077,0.025016034,0.025195197,0.025142314,0.025400339,0.025246461,0.025349615,0.025058184,0.024925005,0.024757240,0.024795994,0.024801460,0.024816914,0.024739919,0.025118767,0.025549882,0.025691170},
{0.025431010,0.024965029,0.025181857,0.024919317,0.024501134,0.024878976,0.024692318,0.024785565,0.025008063,0.025038262,0.025379050,0.025324063,0.025408166,0.025382754,0.025042843,0.024976223,0.024933181,0.024654860,0.024781386,0.024685359,0.024629578,0.025071721,0.025230157,0.025599158},
{0.025297831,0.025151117,0.025068345,0.024978383,0.024652873,0.024472645,0.024793247,0.024785150,0.025029978,0.025022929,0.025252906,0.025563742,0.025371316,0.025230890,0.025004623,0.024813143,0.025009082,0.024875763,0.024611425,0.024708786,0.024795402,0.025012762,0.025309120,0.025548731},
{0.025721106,0.025399932,0.024889291,0.024733178,0.024824873,0.024778629,0.024670475,0.025022828,0.025083641,0.025409538,0.025429159,0.025450972,0.025318564,0.025222098,0.025055109,0.025060127,0.024853420,0.024432123,0.024684395,0.024537390,0.024686153,0.025148035,0.024940895,0.025470499},
{0.025745454,0.025505000,0.025042613,0.024733628,0.024764300,0.024772152,0.024646188,0.024742693,0.024937667,0.025417717,0.025374261,0.025227330,0.025405305,0.024972174,0.025208217,0.024946922,0.024752229,0.024856530,0.024540053,0.024837849,0.024753839,0.025131872,0.025428374,0.025699466},
{0.025795707,0.025476269,0.025010846,0.024815828,0.024772477,0.024583851,0.024760366,0.024699549,0.024989118,0.025074940,0.025119285,0.025247583,0.025235818,0.025383018,0.025154809,0.024990902,0.024755293,0.024880406,0.024663658,0.024815803,0.025108314,0.025249656,0.025542083,0.025488407},
{0.025768869,0.025562952,0.025102667,0.025035934,0.024646757,0.024737123,0.024586333,0.024851355,0.024861028,0.024773144,0.025228836,0.025383050,0.025431581,0.025301966,0.025099239,0.024994862,0.024857982,0.024761786,0.024646070,0.024957814,0.025173505,0.025135016,0.025316539,0.026106779},
{0.025660171,0.025376442,0.025136337,0.024879191,0.024697307,0.024545347,0.024570150,0.025032577,0.025043273,0.025289102,0.025417212,0.025304474,0.025523223,0.025170015,0.024974016,0.024939512,0.025082912,0.024621164,0.024587758,0.024893331,0.024737978,0.024961527,0.025352538,0.025427243},
{0.025763788,0.025513349,0.025125805,0.025050519,0.024584254,0.024714040,0.024598570,0.024806792,0.024936110,0.025259022,0.025138104,0.025390581,0.025338023,0.025215292,0.025100888,0.024804898,0.024601419,0.024567559,0.024592189,0.024803614,0.024807541,0.025138959,0.025158665,0.025694449},
{0.025519660,0.025533414,0.025098760,0.024769383,0.024855026,0.024676876,0.024805086,0.024910772,0.025066073,0.025083011,0.025122351,0.025369200,0.025442481,0.025379520,0.025046803,0.024893693,0.024797676,0.024717560,0.024625711,0.024951553,0.024720002,0.025056172,0.025326655,0.025648045},
{0.025428568,0.025568325,0.025248873,0.025073789,0.024686984,0.024749331,0.024494419,0.024737930,0.024994150,0.025247475,0.025121006,0.025442835,0.025335289,0.025098144,0.025189294,0.024686863,0.024842645,0.024800856,0.024444285,0.024600018,0.025040805,0.025374819,0.025659628,0.025838743},
{0.025817831,0.025638538,0.025065281,0.024857429,0.024786135,0.024592839,0.024688530,0.024903153,0.025017762,0.025088624,0.025537403,0.025161262,0.025325781,0.025530221,0.025042112,0.024811146,0.024788152,0.024779533,0.024824818,0.024901913,0.024946034,0.024990452,0.025245731,0.025726607},
{0.025625029,0.025224201,0.025145377,0.024818013,0.024939856,0.024730810,0.024853424,0.024671946,0.024867386,0.025121720,0.025299499,0.025396823,0.025419207,0.025150313,0.025162911,0.024842697,0.024830672,0.024844049,0.024699028,0.024722077,0.024864359,0.025044888,0.025615433,0.025793687},
{0.025150746,0.025126731,0.025051962,0.024756218,0.024810831,0.024495367,0.024737208,0.024867438,0.024952302,0.025204066,0.025245043,0.025333958,0.025555005,0.025226538,0.024920896,0.025075479,0.024876950,0.024727428,0.024876182,0.024892051,0.024852471,0.025248239,0.025320509,0.025652836},
{0.025558039,0.025630436,0.025241909,0.024940864,0.024810993,0.024783037,0.024675019,0.024867680,0.024901214,0.025191754,0.025257994,0.025403955,0.025325568,0.025376711,0.025417520,0.024924028,0.024670314,0.024650630,0.024587171,0.024837444,0.025105124,0.025167369,0.025584014,0.025734819}};
const double rochcor2015::mmavg[16][24]={{0.025788601,0.024887351,0.024884425,0.024780281,0.024836922,0.024794956,0.024858432,0.024730861,0.024392531,0.024936395,0.025334845,0.025295543,0.025137853,0.025216093,0.025106514,0.025121538,0.025057943,0.024628355,0.024315678,0.024540609,0.024540591,0.025045212,0.025298264,0.026322785},
{0.025322141,0.025801094,0.024805119,0.024615579,0.024877529,0.024585053,0.024488428,0.024602145,0.024912318,0.025309044,0.025221007,0.025444384,0.025405114,0.025286164,0.025253034,0.024917204,0.024745048,0.024592365,0.024728343,0.024690129,0.024865520,0.025160020,0.025298610,0.025643914},
{0.025306707,0.025843020,0.024921235,0.024969940,0.024655226,0.024432443,0.024565582,0.024770957,0.024937926,0.024998275,0.025116208,0.025464838,0.025500607,0.025293677,0.024911992,0.024774440,0.025057362,0.024771085,0.024433538,0.024783586,0.024886190,0.024996979,0.024929713,0.025502341},
{0.025488515,0.024851040,0.025036089,0.024680084,0.024668756,0.024634026,0.024630661,0.024733924,0.025166735,0.025041904,0.025250251,0.025178514,0.025366864,0.025209570,0.024997660,0.025114554,0.024910689,0.024598100,0.024916305,0.024384324,0.024765300,0.025051929,0.025295923,0.025546268},
{0.025463201,0.025398742,0.024809049,0.024701625,0.024797888,0.024416515,0.024754411,0.024728835,0.024743043,0.024814768,0.025076201,0.025457593,0.025663184,0.025411268,0.024800537,0.025220578,0.024999100,0.024980286,0.024977386,0.024620099,0.024531058,0.025301860,0.025300806,0.025537242},
{0.025728244,0.025143036,0.024658014,0.024745956,0.024638564,0.024743656,0.024486017,0.024907377,0.024964841,0.024983128,0.024989874,0.025338469,0.025264862,0.025025207,0.025109121,0.024846864,0.024786657,0.024445868,0.024616072,0.024568609,0.024727978,0.024815771,0.025151916,0.025216598},
{0.025364185,0.025067817,0.025293481,0.024834891,0.024432489,0.024702556,0.024550196,0.024804666,0.025076418,0.024947801,0.025377998,0.025383232,0.025400465,0.025244972,0.025247876,0.024861255,0.024872534,0.024736001,0.024311403,0.024711459,0.024534327,0.025026203,0.025782371,0.025544435},
{0.025517972,0.024997242,0.025031479,0.024712992,0.024959366,0.024500470,0.024870100,0.024734379,0.025088978,0.025196742,0.025470177,0.025298657,0.025320451,0.025453261,0.024910671,0.024677759,0.024900279,0.024610546,0.024688490,0.024748296,0.024824445,0.025137363,0.025262623,0.025542885},
{0.025468641,0.025220806,0.024873036,0.024326794,0.024482432,0.024808182,0.024644942,0.024884111,0.024809304,0.025148785,0.025043949,0.025178682,0.025412876,0.024915600,0.024953249,0.024868734,0.025186157,0.024581571,0.024616848,0.024621132,0.024887709,0.025128669,0.025387572,0.025482328},
{0.025689901,0.024943280,0.025025944,0.024782821,0.025075924,0.024862878,0.024585017,0.024713146,0.025079586,0.025171233,0.024791082,0.025213666,0.025385366,0.025101695,0.024888781,0.024936131,0.024780882,0.024560306,0.024592222,0.024703351,0.024723279,0.024949174,0.025390351,0.025265182},
{0.025144912,0.025264527,0.024914184,0.025014890,0.025021837,0.024683392,0.024496829,0.024653473,0.024746583,0.025117036,0.025481760,0.025306720,0.025401058,0.025328061,0.024943297,0.024844331,0.024915377,0.024512035,0.024792445,0.024402591,0.024672220,0.024897846,0.025188611,0.025089478},
{0.025531573,0.025474614,0.024847912,0.024767420,0.024742939,0.024441707,0.024805030,0.024877159,0.025199804,0.025165789,0.025517915,0.025299063,0.025379877,0.025062246,0.025110238,0.024857960,0.024688289,0.024914369,0.024736711,0.024836229,0.024883834,0.025037391,0.025474435,0.025304228},
{0.024684058,0.024702411,0.024976817,0.024454371,0.024519585,0.024497148,0.024721893,0.024724039,0.024942427,0.025313232,0.025073287,0.025560285,0.025583602,0.025360915,0.025246170,0.024920991,0.024874558,0.024774216,0.024504922,0.024804186,0.025032574,0.024850181,0.025445589,0.025640662},
{0.025629975,0.024883652,0.025125296,0.024730790,0.024497976,0.024689762,0.024686502,0.024787392,0.025063596,0.024993722,0.025299956,0.025158226,0.025352192,0.025137613,0.025169774,0.025083782,0.024767148,0.024915403,0.024651485,0.024779297,0.024858274,0.024983582,0.025547377,0.025542996},
{0.025895567,0.025020301,0.025079219,0.024997465,0.024527541,0.024665048,0.024681551,0.024970199,0.025101201,0.025236563,0.025343788,0.025508219,0.025453270,0.025193293,0.024959350,0.025186535,0.024981978,0.024677287,0.024404178,0.024878863,0.024671506,0.025049369,0.025337372,0.025300996},
{0.025075210,0.025068375,0.025074664,0.024631228,0.024664469,0.024255133,0.024560082,0.025021453,0.024939354,0.024865495,0.024974778,0.025493466,0.025435231,0.024983308,0.024761809,0.024879233,0.024995539,0.024597130,0.024431884,0.024488094,0.024725901,0.025035103,0.025187552,0.025332602}};
const double rochcor2015::mpavg[16][24]={{0.025745044,0.025568798,0.024756680,0.024815707,0.024791314,0.024653799,0.024479765,0.024798800,0.024882855,0.025266135,0.025710281,0.025501955,0.025532183,0.025314563,0.025389051,0.024903327,0.024867522,0.024809716,0.024661476,0.024918296,0.024933686,0.024632263,0.025298063,0.025788699},
{0.025947789,0.025240923,0.024877433,0.024884936,0.024722547,0.024737953,0.024772511,0.024848846,0.024906775,0.025093678,0.025293923,0.025406166,0.025412033,0.025408360,0.024965891,0.024774977,0.024887070,0.024676780,0.024531798,0.024765630,0.024827917,0.025157408,0.025540655,0.025835105},
{0.025376331,0.025637771,0.025133394,0.024517253,0.024853570,0.024411288,0.024553426,0.024571163,0.024809227,0.024956309,0.025377276,0.025305676,0.025446325,0.025142911,0.025315458,0.025065447,0.024779353,0.024751784,0.024368969,0.024804760,0.024848561,0.024962933,0.025495468,0.025653696},
{0.025018663,0.025363320,0.024959121,0.024918333,0.024451023,0.024594194,0.024514596,0.024749387,0.024682371,0.025050536,0.025403550,0.025542671,0.025634846,0.025121449,0.025264802,0.024835747,0.024970134,0.024767782,0.024631347,0.024512757,0.024491619,0.025337419,0.025483683,0.025158435},
{0.025770117,0.025056312,0.025112564,0.024691754,0.024677782,0.024610332,0.024440669,0.025083833,0.024944767,0.025242209,0.025480198,0.025394823,0.025559225,0.025466237,0.025281185,0.024802225,0.024721733,0.024812300,0.024883450,0.024407870,0.024729750,0.025059799,0.025863051,0.025766063},
{0.025473541,0.025659861,0.025314109,0.024737843,0.024725768,0.024464076,0.024677057,0.024869654,0.024997330,0.025189257,0.025071203,0.025368292,0.025296977,0.025440582,0.025106670,0.024762616,0.024704818,0.024730913,0.024718068,0.024591149,0.024813239,0.025097968,0.025314659,0.025828867},
{0.025740948,0.025445233,0.025005742,0.024872498,0.024641391,0.024704145,0.024782455,0.024632688,0.025064647,0.025161437,0.025340741,0.025535053,0.025309395,0.025241925,0.025130918,0.024887052,0.024797160,0.024773969,0.024804235,0.024388467,0.024738553,0.024797576,0.025204227,0.025724213},
{0.025661023,0.025495489,0.025175930,0.024762248,0.024666290,0.024568689,0.024672778,0.024951771,0.025010693,0.025172874,0.025410064,0.025274313,0.025467932,0.025238708,0.025261371,0.024982110,0.024768638,0.024848557,0.024566088,0.024766421,0.024715301,0.024775389,0.025588660,0.025560493},
{0.025801231,0.025416209,0.025188111,0.024770781,0.024671957,0.024612337,0.024825911,0.024766280,0.025038161,0.025141374,0.025299159,0.025528459,0.025195199,0.025155276,0.024745444,0.025115705,0.025153469,0.024885373,0.024954858,0.024740623,0.024613429,0.025158245,0.025257575,0.025776163},
{0.025594921,0.025032241,0.025231381,0.024588874,0.024685427,0.024825486,0.024721250,0.025058046,0.024970718,0.025098435,0.025332318,0.025400719,0.025238303,0.025199772,0.024888496,0.024842409,0.024657338,0.024761702,0.024822308,0.024423884,0.025023727,0.024828940,0.025574340,0.025493864},
{0.025831426,0.025224156,0.025096553,0.024940884,0.024730693,0.024841792,0.024583313,0.024888053,0.024910474,0.025219358,0.025709670,0.025426446,0.025183648,0.025271320,0.025191224,0.024834301,0.025010347,0.024671813,0.024379977,0.024405907,0.025125151,0.024982025,0.025396194,0.025572484},
{0.025269967,0.025569805,0.025203151,0.024772965,0.024539949,0.024781403,0.024470376,0.025087960,0.024760475,0.024934114,0.025397599,0.025346682,0.025620791,0.025321521,0.025306769,0.025077509,0.025023039,0.024596545,0.024505467,0.024597988,0.024658654,0.024945036,0.025389042,0.025353579},
{0.025806035,0.025144565,0.025210443,0.025127642,0.024754913,0.024500498,0.024610694,0.024852893,0.025181576,0.025192743,0.025391449,0.025383114,0.025177513,0.025125450,0.025254096,0.024863889,0.025106195,0.024578946,0.024608899,0.024860286,0.025007448,0.025301245,0.025204803,0.025374186},
{0.025412873,0.025387277,0.024975083,0.024937290,0.024752242,0.024548486,0.024750047,0.024951930,0.025252885,0.025078192,0.025377253,0.025303303,0.025517353,0.025177389,0.024862070,0.024984309,0.024964187,0.024783059,0.024583358,0.024586217,0.024951861,0.025038000,0.025525660,0.025389378},
{0.025258631,0.025504679,0.025138124,0.024877266,0.024654710,0.024516485,0.024932899,0.024932469,0.024835415,0.025284347,0.025058011,0.025657933,0.025366502,0.025402643,0.025286722,0.024932245,0.024644683,0.024902423,0.024796401,0.024465585,0.024812247,0.025049558,0.025630256,0.025389320},
{0.025660131,0.025820658,0.024993093,0.025099986,0.024944318,0.024721777,0.024389061,0.024759542,0.025057217,0.025201402,0.025542577,0.025677342,0.025139472,0.025226763,0.024944714,0.024796608,0.025105082,0.024935586,0.024727905,0.024932629,0.024880324,0.024961472,0.024775873,0.026099408}};
//==========================================================================================================================
const double rochcor2015::dcor_bfer[16][24]={{0.000201470,0.000184175,0.000132708,0.000124473,0.000133733,0.000126973,0.000123788,0.000118904,0.000170022,0.000113153,0.000117662,0.000114658,0.000114820,0.000116599,0.000111767,0.000115788,0.000130387,0.000123215,0.000126108,0.000129104,0.000124872,0.000145966,0.000186915,0.000200188},
{0.000193895,0.000181921,0.000133539,0.000125769,0.000131019,0.000126533,0.000124794,0.000119119,0.000113236,0.000114620,0.000122600,0.000122355,0.000113918,0.000117774,0.000114399,0.000117225,0.000120353,0.000122237,0.000123671,0.000130477,0.000122210,0.000130517,0.000187557,0.000198187},
{0.000191930,0.000186341,0.000135591,0.000121826,0.000131751,0.000131974,0.000124324,0.000121726,0.000118310,0.000115147,0.000117173,0.000117007,0.000111019,0.000114839,0.000115932,0.000118630,0.000124145,0.000123474,0.000126653,0.000130628,0.000124027,0.000134149,0.000179855,0.000198760},
{0.000200736,0.000183648,0.000134056,0.000124521,0.000134789,0.000126121,0.000121776,0.000120974,0.000117100,0.000114682,0.000118235,0.000115469,0.000116575,0.000116892,0.000117669,0.000117128,0.000121681,0.000120682,0.000125969,0.000131696,0.000128807,0.000133395,0.000179208,0.000195705},
{0.000195285,0.000183298,0.000131919,0.000123019,0.000132153,0.000126573,0.000125085,0.000118581,0.000115409,0.000113428,0.000118701,0.000117163,0.000114212,0.000116420,0.000114952,0.000118560,0.000122993,0.000123510,0.000128553,0.000135668,0.000125573,0.000135573,0.000193187,0.000194591},
{0.000193910,0.000182562,0.000128351,0.000126829,0.000133822,0.000132388,0.000120283,0.000119148,0.000115637,0.000114976,0.000116019,0.000114846,0.000115517,0.000114696,0.000113349,0.000115361,0.000122209,0.000122669,0.000126681,0.000133909,0.000176460,0.000131306,0.000182623,0.000195843},
{0.000188791,0.000189353,0.000132806,0.000123801,0.000142975,0.000128204,0.000120884,0.000119354,0.000115926,0.000114943,0.000115622,0.000115414,0.000112786,0.000115407,0.000113983,0.000115172,0.000121903,0.000122891,0.000127564,0.000130071,0.000123030,0.000135075,0.000179951,0.000197200},
{0.000188306,0.000188638,0.000137857,0.000123346,0.000131388,0.000125726,0.000123973,0.000118434,0.000119185,0.000116110,0.000119106,0.000114173,0.000116271,0.000114683,0.000115610,0.000116198,0.000120178,0.000122657,0.000126320,0.000133614,0.000126442,0.000139130,0.000217589,0.000200657},
{0.000186916,0.000187954,0.000132807,0.000126463,0.000144768,0.000124918,0.000121894,0.000121190,0.000118063,0.000111688,0.000114504,0.000113433,0.000115321,0.000116208,0.000124465,0.000117239,0.000122343,0.000124281,0.000121686,0.000133553,0.000123606,0.000138337,0.000181067,0.000190101},
{0.000197765,0.000187140,0.000137250,0.000126877,0.000129874,0.000124200,0.000122898,0.000119296,0.000114388,0.000113510,0.000117246,0.000115661,0.000115053,0.000115191,0.000111626,0.000115153,0.000117341,0.000124095,0.000126803,0.000131209,0.000124308,0.000135907,0.000186352,0.000191926},
{0.000198844,0.000185703,0.000132705,0.000125521,0.000131572,0.000124963,0.000122127,0.000119188,0.000113535,0.000114983,0.000132468,0.000116084,0.000116864,0.000115770,0.000115963,0.000115854,0.000122365,0.000124402,0.000127881,0.000131579,0.000123698,0.000134826,0.000185871,0.000200324},
{0.000189311,0.000183256,0.000130219,0.000122242,0.000133129,0.000126342,0.000119902,0.000119695,0.000116492,0.000114107,0.000121391,0.000113444,0.000113857,0.000134344,0.000115239,0.000115994,0.000128598,0.000120862,0.000126110,0.000133187,0.000123995,0.000133993,0.000187008,0.000197743},
{0.000201343,0.000185722,0.000134999,0.000124150,0.000130578,0.000125647,0.000118992,0.000120410,0.000118203,0.000115064,0.000115584,0.000115722,0.000116713,0.000134677,0.000156721,0.000116136,0.000120472,0.000124095,0.000126542,0.000133754,0.000129065,0.000134273,0.000189787,0.000203411},
{0.000203446,0.000182255,0.000141727,0.000124710,0.000133525,0.000131525,0.000122014,0.000117184,0.000116588,0.000115004,0.000114014,0.000114635,0.000112112,0.000115511,0.000115010,0.000114329,0.000118574,0.000123470,0.000128644,0.000129954,0.000121924,0.000132762,0.000186404,0.000196211},
{0.000237329,0.000182630,0.000132328,0.000124904,0.000134535,0.000127330,0.000119707,0.000129492,0.000113406,0.000114484,0.000113570,0.000113367,0.000116515,0.000114221,0.000112729,0.000115329,0.000122665,0.000120987,0.000128824,0.000131075,0.000123502,0.000134297,0.000188074,0.000196051},
{0.000191714,0.000188286,0.000136101,0.000123727,0.000132579,0.000144031,0.000125326,0.000119549,0.000115583,0.000114023,0.000114966,0.000114292,0.000114855,0.000115287,0.000156376,0.000119461,0.000122044,0.000123015,0.000125166,0.000134283,0.000121795,0.000140026,0.000186289,0.000198279}};
const double rochcor2015::dcor_maer[16][24]={{0.000201470,0.000184175,0.000132708,0.000124473,0.000133733,0.000126973,0.000123788,0.000118904,0.000170022,0.000113153,0.000117662,0.000114658,0.000114820,0.000116599,0.000111767,0.000115788,0.000130387,0.000123215,0.000126108,0.000129104,0.000124872,0.000145966,0.000186915,0.000200188},
{0.000193895,0.000181921,0.000133539,0.000125769,0.000131019,0.000126533,0.000124794,0.000119119,0.000113236,0.000114620,0.000122600,0.000122355,0.000113918,0.000117774,0.000114399,0.000117225,0.000120353,0.000122237,0.000123671,0.000130477,0.000122210,0.000130517,0.000187557,0.000198187},
{0.000191930,0.000186341,0.000135591,0.000121826,0.000131751,0.000131974,0.000124324,0.000121726,0.000118310,0.000115147,0.000117173,0.000117007,0.000111019,0.000114839,0.000115932,0.000118630,0.000124145,0.000123474,0.000126653,0.000130628,0.000124027,0.000134149,0.000179855,0.000198760},
{0.000200736,0.000183648,0.000134056,0.000124521,0.000134789,0.000126121,0.000121776,0.000120974,0.000117100,0.000114682,0.000118235,0.000115469,0.000116575,0.000116892,0.000117669,0.000117128,0.000121681,0.000120682,0.000125969,0.000131696,0.000128807,0.000133395,0.000179208,0.000195705},
{0.000195285,0.000183298,0.000131919,0.000123019,0.000132153,0.000126573,0.000125085,0.000118581,0.000115409,0.000113428,0.000118701,0.000117163,0.000114212,0.000116420,0.000114952,0.000118560,0.000122993,0.000123510,0.000128553,0.000135668,0.000125573,0.000135573,0.000193187,0.000194591},
{0.000193910,0.000182562,0.000128351,0.000126829,0.000133822,0.000132388,0.000120283,0.000119148,0.000115637,0.000114976,0.000116019,0.000114846,0.000115517,0.000114696,0.000113349,0.000115361,0.000122209,0.000122669,0.000126681,0.000133909,0.000176460,0.000131306,0.000182623,0.000195843},
{0.000188791,0.000189353,0.000132806,0.000123801,0.000142975,0.000128204,0.000120884,0.000119354,0.000115926,0.000114943,0.000115622,0.000115414,0.000112786,0.000115407,0.000113983,0.000115172,0.000121903,0.000122891,0.000127564,0.000130071,0.000123030,0.000135075,0.000179951,0.000197200},
{0.000188306,0.000188638,0.000137857,0.000123346,0.000131388,0.000125726,0.000123973,0.000118434,0.000119185,0.000116110,0.000119106,0.000114173,0.000116271,0.000114683,0.000115610,0.000116198,0.000120178,0.000122657,0.000126320,0.000133614,0.000126442,0.000139130,0.000217589,0.000200657},
{0.000186916,0.000187954,0.000132807,0.000126463,0.000144768,0.000124918,0.000121894,0.000121190,0.000118063,0.000111688,0.000114504,0.000113433,0.000115321,0.000116208,0.000124465,0.000117239,0.000122343,0.000124281,0.000121686,0.000133553,0.000123606,0.000138337,0.000181067,0.000190101},
{0.000197765,0.000187140,0.000137250,0.000126877,0.000129874,0.000124200,0.000122898,0.000119296,0.000114388,0.000113510,0.000117246,0.000115661,0.000115053,0.000115191,0.000111626,0.000115153,0.000117341,0.000124095,0.000126803,0.000131209,0.000124308,0.000135907,0.000186352,0.000191926},
{0.000198844,0.000185703,0.000132705,0.000125521,0.000131572,0.000124963,0.000122127,0.000119188,0.000113535,0.000114983,0.000132468,0.000116084,0.000116864,0.000115770,0.000115963,0.000115854,0.000122365,0.000124402,0.000127881,0.000131579,0.000123698,0.000134826,0.000185871,0.000200324},
{0.000189311,0.000183256,0.000130219,0.000122242,0.000133129,0.000126342,0.000119902,0.000119695,0.000116492,0.000114107,0.000121391,0.000113444,0.000113857,0.000134344,0.000115239,0.000115994,0.000128598,0.000120862,0.000126110,0.000133187,0.000123995,0.000133993,0.000187008,0.000197743},
{0.000201343,0.000185722,0.000134999,0.000124150,0.000130578,0.000125647,0.000118992,0.000120410,0.000118203,0.000115064,0.000115584,0.000115722,0.000116713,0.000134677,0.000156721,0.000116136,0.000120472,0.000124095,0.000126542,0.000133754,0.000129065,0.000134273,0.000189787,0.000203411},
{0.000203446,0.000182255,0.000141727,0.000124710,0.000133525,0.000131525,0.000122014,0.000117184,0.000116588,0.000115004,0.000114014,0.000114635,0.000112112,0.000115511,0.000115010,0.000114329,0.000118574,0.000123470,0.000128644,0.000129954,0.000121924,0.000132762,0.000186404,0.000196211},
{0.000237329,0.000182630,0.000132328,0.000124904,0.000134535,0.000127330,0.000119707,0.000129492,0.000113406,0.000114484,0.000113570,0.000113367,0.000116515,0.000114221,0.000112729,0.000115329,0.000122665,0.000120987,0.000128824,0.000131075,0.000123502,0.000134297,0.000188074,0.000196051},
{0.000191714,0.000188286,0.000136101,0.000123727,0.000132579,0.000144031,0.000125326,0.000119549,0.000115583,0.000114023,0.000114966,0.000114292,0.000114855,0.000115287,0.000156376,0.000119461,0.000122044,0.000123015,0.000125166,0.000134283,0.000121795,0.000140026,0.000186289,0.000198279}};
const double rochcor2015::mcor_bfer[16][24]={{0.000238734,0.000210406,0.000154304,0.000144286,0.000154012,0.000148774,0.000143183,0.000137551,0.000214359,0.000131161,0.000137572,0.000134215,0.000133997,0.000136280,0.000130036,0.000135407,0.000154305,0.000143117,0.000146930,0.000150611,0.000145732,0.000173779,0.000215339,0.000230448},
{0.000222816,0.000208558,0.000155311,0.000144784,0.000151714,0.000147181,0.000145568,0.000138565,0.000130440,0.000132367,0.000145170,0.000144616,0.000132391,0.000138062,0.000132713,0.000136654,0.000140136,0.000141911,0.000143647,0.000151212,0.000141158,0.000151776,0.000215211,0.000224137},
{0.000220525,0.000214011,0.000156725,0.000141406,0.000152877,0.000154845,0.000143678,0.000142811,0.000138321,0.000132722,0.000136762,0.000136527,0.000127029,0.000131747,0.000135873,0.000139548,0.000145013,0.000143285,0.000148060,0.000149873,0.000143083,0.000156358,0.000208584,0.000224657},
{0.000233354,0.000209928,0.000155008,0.000144255,0.000156372,0.000146651,0.000139929,0.000140699,0.000136535,0.000132447,0.000136551,0.000133431,0.000136229,0.000135915,0.000137540,0.000136107,0.000140788,0.000139076,0.000143890,0.000151282,0.000149007,0.000155073,0.000205066,0.000223657},
{0.000227292,0.000213550,0.000155084,0.000145214,0.000154064,0.000148709,0.000145267,0.000138193,0.000132131,0.000131850,0.000138054,0.000136903,0.000131657,0.000135746,0.000136351,0.000136898,0.000143366,0.000142570,0.000150977,0.000158604,0.000145682,0.000156075,0.000223877,0.000220972},
{0.000224823,0.000211741,0.000147265,0.000148140,0.000157190,0.000155368,0.000138195,0.000137279,0.000133875,0.000134346,0.000135372,0.000134056,0.000134780,0.000132660,0.000131468,0.000134676,0.000142489,0.000143501,0.000148341,0.000156279,0.000224236,0.000152465,0.000204462,0.000224540},
{0.000218464,0.000221211,0.000153137,0.000143936,0.000170279,0.000149479,0.000139999,0.000139004,0.000134565,0.000133966,0.000132500,0.000134819,0.000131250,0.000134153,0.000132456,0.000133671,0.000144494,0.000142640,0.000148572,0.000150598,0.000141590,0.000155738,0.000203395,0.000225477},
{0.000209898,0.000216159,0.000158148,0.000141238,0.000153980,0.000146575,0.000143750,0.000135916,0.000138542,0.000136422,0.000139265,0.000132705,0.000135039,0.000133047,0.000136023,0.000134601,0.000138832,0.000142225,0.000146509,0.000154519,0.000145992,0.000162590,0.000258575,0.000228479},
{0.000214114,0.000213909,0.000153240,0.000145972,0.000173284,0.000144944,0.000141565,0.000141268,0.000138562,0.000129997,0.000132960,0.000132356,0.000134272,0.000133524,0.000149044,0.000137275,0.000144870,0.000143111,0.000140611,0.000157169,0.000143244,0.000161963,0.000208340,0.000213966},
{0.000229572,0.000213249,0.000160899,0.000146802,0.000150026,0.000145430,0.000143767,0.000138762,0.000133732,0.000132257,0.000135749,0.000135815,0.000132691,0.000132045,0.000129065,0.000133775,0.000136568,0.000145034,0.000147777,0.000151575,0.000145631,0.000158495,0.000216122,0.000222013},
{0.000230549,0.000213502,0.000153747,0.000146793,0.000151585,0.000145604,0.000141833,0.000136916,0.000131223,0.000133178,0.000152675,0.000134870,0.000137044,0.000134988,0.000134928,0.000135089,0.000142352,0.000144722,0.000149893,0.000152819,0.000144840,0.000156835,0.000213888,0.000229297},
{0.000215901,0.000212496,0.000153194,0.000142794,0.000156717,0.000146744,0.000139431,0.000139423,0.000135189,0.000133474,0.000141099,0.000131045,0.000131034,0.000155727,0.000133840,0.000135596,0.000152274,0.000139483,0.000144471,0.000156106,0.000143752,0.000154391,0.000216941,0.000232266},
{0.000234841,0.000211472,0.000156781,0.000144644,0.000152250,0.000145633,0.000135923,0.000138947,0.000138980,0.000134910,0.000133730,0.000133837,0.000140045,0.000152075,0.000196175,0.000134264,0.000139411,0.000144677,0.000146648,0.000157121,0.000150525,0.000157562,0.000222054,0.000236036},
{0.000231815,0.000208949,0.000168393,0.000145512,0.000156733,0.000155122,0.000142617,0.000135209,0.000135669,0.000134258,0.000132442,0.000133687,0.000129683,0.000133036,0.000133611,0.000131148,0.000136932,0.000144505,0.000150144,0.000151095,0.000140973,0.000152179,0.000215874,0.000228863},
{0.000282213,0.000212257,0.000151964,0.000145577,0.000157342,0.000146797,0.000137720,0.000154008,0.000130417,0.000132258,0.000130273,0.000131223,0.000136004,0.000134847,0.000130982,0.000133240,0.000142781,0.000140575,0.000148715,0.000152214,0.000144183,0.000157030,0.000221788,0.000223143},
{0.000216797,0.000215836,0.000156805,0.000142336,0.000155948,0.000172123,0.000145764,0.000137669,0.000134622,0.000133529,0.000133078,0.000133182,0.000133423,0.000133941,0.000195219,0.000140035,0.000137383,0.000141497,0.000146215,0.000156626,0.000140329,0.000163677,0.000217758,0.000229439}};
const double rochcor2015::mcor_maer[16][24]={{0.000238734,0.000210406,0.000154304,0.000144286,0.000154012,0.000148774,0.000143183,0.000137551,0.000214359,0.000131161,0.000137572,0.000134215,0.000133997,0.000136280,0.000130036,0.000135407,0.000154305,0.000143117,0.000146930,0.000150611,0.000145732,0.000173779,0.000215339,0.000230448},
{0.000222816,0.000208558,0.000155311,0.000144784,0.000151714,0.000147181,0.000145568,0.000138565,0.000130440,0.000132367,0.000145170,0.000144616,0.000132391,0.000138062,0.000132713,0.000136654,0.000140136,0.000141911,0.000143647,0.000151212,0.000141158,0.000151776,0.000215211,0.000224137},
{0.000220525,0.000214011,0.000156725,0.000141406,0.000152877,0.000154845,0.000143678,0.000142811,0.000138321,0.000132722,0.000136762,0.000136527,0.000127029,0.000131747,0.000135873,0.000139548,0.000145013,0.000143285,0.000148060,0.000149873,0.000143083,0.000156358,0.000208584,0.000224657},
{0.000233354,0.000209928,0.000155008,0.000144255,0.000156372,0.000146651,0.000139929,0.000140699,0.000136535,0.000132447,0.000136551,0.000133431,0.000136229,0.000135915,0.000137540,0.000136107,0.000140788,0.000139076,0.000143890,0.000151282,0.000149007,0.000155073,0.000205066,0.000223657},
{0.000227292,0.000213550,0.000155084,0.000145214,0.000154064,0.000148709,0.000145267,0.000138193,0.000132131,0.000131850,0.000138054,0.000136903,0.000131657,0.000135746,0.000136351,0.000136898,0.000143366,0.000142570,0.000150977,0.000158604,0.000145682,0.000156075,0.000223877,0.000220972},
{0.000224823,0.000211741,0.000147265,0.000148140,0.000157190,0.000155368,0.000138195,0.000137279,0.000133875,0.000134346,0.000135372,0.000134056,0.000134780,0.000132660,0.000131468,0.000134676,0.000142489,0.000143501,0.000148341,0.000156279,0.000224236,0.000152465,0.000204462,0.000224540},
{0.000218464,0.000221211,0.000153137,0.000143936,0.000170279,0.000149479,0.000139999,0.000139004,0.000134565,0.000133966,0.000132500,0.000134819,0.000131250,0.000134153,0.000132456,0.000133671,0.000144494,0.000142640,0.000148572,0.000150598,0.000141590,0.000155738,0.000203395,0.000225477},
{0.000209898,0.000216159,0.000158148,0.000141238,0.000153980,0.000146575,0.000143750,0.000135916,0.000138542,0.000136422,0.000139265,0.000132705,0.000135039,0.000133047,0.000136023,0.000134601,0.000138832,0.000142225,0.000146509,0.000154519,0.000145992,0.000162590,0.000258575,0.000228479},
{0.000214114,0.000213909,0.000153240,0.000145972,0.000173284,0.000144944,0.000141565,0.000141268,0.000138562,0.000129997,0.000132960,0.000132356,0.000134272,0.000133524,0.000149044,0.000137275,0.000144870,0.000143111,0.000140611,0.000157169,0.000143244,0.000161963,0.000208340,0.000213966},
{0.000229572,0.000213249,0.000160899,0.000146802,0.000150026,0.000145430,0.000143767,0.000138762,0.000133732,0.000132257,0.000135749,0.000135815,0.000132691,0.000132045,0.000129065,0.000133775,0.000136568,0.000145034,0.000147777,0.000151575,0.000145631,0.000158495,0.000216122,0.000222013},
{0.000230549,0.000213502,0.000153747,0.000146793,0.000151585,0.000145604,0.000141833,0.000136916,0.000131223,0.000133178,0.000152675,0.000134870,0.000137044,0.000134988,0.000134928,0.000135089,0.000142352,0.000144722,0.000149893,0.000152819,0.000144840,0.000156835,0.000213888,0.000229297},
{0.000215901,0.000212496,0.000153194,0.000142794,0.000156717,0.000146744,0.000139431,0.000139423,0.000135189,0.000133474,0.000141099,0.000131045,0.000131034,0.000155727,0.000133840,0.000135596,0.000152274,0.000139483,0.000144471,0.000156106,0.000143752,0.000154391,0.000216941,0.000232266},
{0.000234841,0.000211472,0.000156781,0.000144644,0.000152250,0.000145633,0.000135923,0.000138947,0.000138980,0.000134910,0.000133730,0.000133837,0.000140045,0.000152075,0.000196175,0.000134264,0.000139411,0.000144677,0.000146648,0.000157121,0.000150525,0.000157562,0.000222054,0.000236036},
{0.000231815,0.000208949,0.000168393,0.000145512,0.000156733,0.000155122,0.000142617,0.000135209,0.000135669,0.000134258,0.000132442,0.000133687,0.000129683,0.000133036,0.000133611,0.000131148,0.000136932,0.000144505,0.000150144,0.000151095,0.000140973,0.000152179,0.000215874,0.000228863},
{0.000282213,0.000212257,0.000151964,0.000145577,0.000157342,0.000146797,0.000137720,0.000154008,0.000130417,0.000132258,0.000130273,0.000131223,0.000136004,0.000134847,0.000130982,0.000133240,0.000142781,0.000140575,0.000148715,0.000152214,0.000144183,0.000157030,0.000221788,0.000223143},
{0.000216797,0.000215836,0.000156805,0.000142336,0.000155948,0.000172123,0.000145764,0.000137669,0.000134622,0.000133529,0.000133078,0.000133182,0.000133423,0.000133941,0.000195219,0.000140035,0.000137383,0.000141497,0.000146215,0.000156626,0.000140329,0.000163677,0.000217758,0.000229439}};

//==========================================================================================================================

const double rochcor2015::dd[12]={0.0135375,0.0129037,0.00458473,0.0294874,0.0261289,0.0234373,0.0362774,0.02023,0.0172767,0.0558127,0.0741892,0.135656};
const double rochcor2015::md[12]={0.00501882,0.000352594,-0.00308157,0.00998455,-0.00484126,-0.00594442,0.0168821,-0.00368368,0.0167904,0.0444465,0.0411393,0.033297};

const double rochcor2015::dscl[24]={0.99773,0.999572,0.999306,1.0002,0.999934,0.999476,0.999929,1.00072,1.00068,1.00039,1.00181,1.00082,1.00128,1.00037,1.00003,1.00034,1.00178,0.999859,1.00054,0.998944,0.999143,0.998824,1.00017,0.998395};
const double rochcor2015::mscl[24]={0.99864,0.999234,0.999045,1.00014,1.00004,0.998991,0.999458,0.999517,1.00055,1.00004,1.00052,1.00051,1.00102,1.00071,1.0005,1.00032,1.00058,1.00043,0.9999,0.999465,0.999707,0.99995,0.99993,0.997877};

muresolution muresol1;

//===============================================================================================

rochcor2015::~rochcor2015(){
}

rochcor2015::rochcor2015(){
  
  eran.SetSeed(123456);
  sran.SetSeed(1234);
  
  gscler_mc_dev=0;
  gscler_da_dev=0;

  for(int i=0; i<16; ++i){
      for(int j=0; j<24; ++j){
          mptsys_mc_dm[i][j]=0;
          mptsys_mc_da[i][j]=0;
          mptsys_da_dm[i][j]=0;
          mptsys_da_da[i][j]=0;
      }
  }

}

rochcor2015::rochcor2015(int seed){
  eran.SetSeed(123456);
  sran.SetSeed(seed);

  gscler_mc_dev=sran.Gaus(0.0, 1.0);
  gscler_da_dev=sran.Gaus(0.0, 1.0);

  for(int i=0; i<16; ++i){
      for(int j=0; j<24; ++j){
          mptsys_mc_dm[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_mc_da[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_da_dm[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_da_da[i][j]=sran.Gaus(0.0, 1.0);
      }
  }
}

void rochcor2015::momcor_mc( TLorentzVector& mu, float charge, int ntrk, float& qter){
  
  //sysdev == num : deviation = num
  double mupt_bfcor = mu.Pt();
  double mupt = mu.Pt();
  double muphi = mu.Phi();
  double mueta = mu.Eta(); // same with mu.Eta() in Root
/*
  double px = mu.Px();
  double py = mu.Py();
  double pz = mu.Pz();
  double e = mu.E();
*/
  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  int mu_aetabin = aetabin(mueta);
  
  if(mu_phibin>=0 && mu_etabin>=0){
    
    double Mf = (mcor_bf[mu_phibin][mu_etabin] + mptsys_mc_dm[mu_phibin][mu_etabin]*mcor_bfer[mu_phibin][mu_etabin])/(mpavg[mu_phibin][mu_etabin]+mmavg[mu_phibin][mu_etabin]);
    double Af = ((mcor_ma[mu_phibin][mu_etabin]+mptsys_mc_da[mu_phibin][mu_etabin]*mcor_maer[mu_phibin][mu_etabin]) - Mf*(mpavg[mu_phibin][mu_etabin]-mmavg[mu_phibin][mu_etabin]));     
    
    double cor = 1.0/(1.0 + 2.0*Mf + charge*Af*mupt);
    
    //for the momentum tuning - eta,phi,Q correction
    mupt *= cor;
    
    double gscl = (genm_smr/mrecm);
    double gscler = mgscl_stat;    
    double tune = muresol1.kSmear(mupt,mueta,ntrk,muresolution::Extra);

    mupt *= (gscl + gscler_mc_dev*gscler)*(tune*mscl[mu_etabin]);    

    double pt_tune = (mupt-md[mu_aetabin])*45.0/(45.0-md[mu_aetabin]);
    mupt = pt_tune;

    double momscl = mupt_bfcor/mupt;
    qter *= sqrt(momscl*momscl + (1.0-tune)*(1.0-tune));
    
  }
  
  mu.SetPtEtaPhiM(mupt,mueta,muphi,mu_mass);
}


void rochcor2015::momcor_data( TLorentzVector& mu, float charge, int runopt, float& qter){
  
  double mupt_bfcor = mu.Pt();
  double mupt = mu.Pt();
  
  double muphi = mu.Phi();
  double mueta = mu.Eta(); // same with mu.Eta() in Root
/*  
  double px = mu.Px();
  double py = mu.Py();
  double pz = mu.Pz();
  double e = mu.E();
*/  
  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  int mu_aetabin = aetabin(mueta);

  if(mu_phibin>=0 && mu_etabin>=0){
    
    double Mf = (dcor_bf[mu_phibin][mu_etabin]+mptsys_da_dm[mu_phibin][mu_etabin]*dcor_bfer[mu_phibin][mu_etabin])/(dpavg[mu_phibin][mu_etabin]+dmavg[mu_phibin][mu_etabin]);
    double Af = ((dcor_ma[mu_phibin][mu_etabin]+mptsys_da_da[mu_phibin][mu_etabin]*dcor_maer[mu_phibin][mu_etabin]) - Mf*(dpavg[mu_phibin][mu_etabin]-dmavg[mu_phibin][mu_etabin]));     
    
    double cor = 1.0/(1.0 + 2.0*Mf + charge*Af*mupt);
    
    mupt *= cor;  
    
    //after Z pt correction
    double gscl = (genm_smr/drecm);
    double gscler = dgscl_stat;

    mupt *= (gscl + gscler_da_dev*gscler)*dscl[mu_etabin];
    
    double pt_tune = (mupt-dd[mu_aetabin])*45.0/(45.0-dd[mu_aetabin]);
    mupt = pt_tune; 

    double momscl = mupt_bfcor/mupt;
    qter *= momscl;
    
  }
  
  mu.SetPtEtaPhiM(mupt,mueta,muphi,mu_mass);
  
}

Int_t rochcor2015::phibin(double phi){
  
  int nphibin = -1;
  
  for(int i=0; i<16; i++){
    if(-pi+(2.0*pi/16.0)*i <= phi && -pi+(2.0*pi/16.0)*(i+1) > phi){
      nphibin = i;
      break;
    }
  }
  
  return nphibin;
}

Int_t rochcor2015::etabin(double eta){
  
  int nbin = -1;
  
  for(int i=0; i<24; i++){
    if(netabin[i] <= eta && netabin[i+1] > eta){
      nbin = i;
      break;
    }
  }
  
  return nbin;
}



Int_t rochcor2015::aetabin(double eta){
  
  int nbin = -1;
  
  for(int i=0; i<12; i++){
    if(anetabin[i] <= fabs(eta) && anetabin[i+1] > fabs(eta)){
      nbin = i;
      break;
    }
  }
  
  return nbin;
}

