#define rochcor2016_cxx
#include "ExoAnalysis/cmsWR/interface/rochcor2016.h"
#include "TLorentzVector.h"


const double rochcor2016::netabin[25] = {-2.4,-2.25,-2.1,-1.85,-1.6,-1.4,-1.2,-1.0,-0.8,-0.6,-0.4,-0.2,
					 0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.85,2.1,2.25,2.4};

const double rochcor2016::anetabin[13] = {0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.85,2.1,2.25,2.4};


//---------------------------------------------------------------------------------------------  
const double rochcor2016::dcor_bf[16][24]={{-0.000040171,-0.000078514,0.000010323,-0.000041185,-0.000017882,-0.000032108,-0.000009584,0.000048948,0.000044261,0.000031321,0.000081061,0.000052479,0.000028012,0.000062147,0.000054199,0.000028345,0.000058645,0.000003409,0.000001121,0.000006251,-0.000021399,-0.000051319,-0.000037758,-0.000014689},
{-0.000074185,-0.000133023,-0.000027325,-0.000062960,-0.000002125,-0.000029197,-0.000009503,0.000011895,0.000055589,0.000011028,0.000020311,0.000075197,0.000070320,0.000015056,0.000036471,0.000033014,0.000020004,0.000006135,-0.000012982,-0.000046719,-0.000036836,-0.000049654,-0.000070876,-0.000006909},
{-0.000113719,0.000000785,-0.000046435,-0.000038672,-0.000020045,-0.000050417,0.000046080,0.000025229,0.000005418,0.000067922,0.000049495,0.000061469,0.000034415,0.000040374,0.000055738,0.000064007,0.000021456,0.000017754,0.000012378,-0.000006971,0.000007037,-0.000000323,-0.000049204,-0.000035959},
{0.000040031,-0.000043334,-0.000038538,-0.000032681,-0.000021416,0.000004025,0.000027976,0.000025426,0.000022432,0.000039929,0.000032650,0.000059244,0.000074569,0.000055343,0.000025080,0.000012090,-0.000006191,0.000036480,-0.000013639,0.000018673,-0.000015926,0.000007787,0.000003404,-0.000085551},
{-0.000073206,0.000054131,-0.000031769,0.000015671,-0.000003952,0.000045410,-0.000017785,0.000022477,0.000012226,0.000042796,0.000022113,0.000026951,0.000028585,0.000040098,0.000068306,0.000034067,0.000052376,0.000037601,0.000006003,0.000050131,0.000006234,0.000009043,-0.000007939,-0.000025084},
{-0.000033312,-0.000059284,-0.000038989,-0.000029444,-0.000018673,0.000007264,0.000025058,0.000028972,0.000002185,0.000025961,0.000033307,0.000031387,0.000045515,0.000081841,0.000027806,0.000050272,0.000062160,0.000028329,0.000018562,-0.000033136,-0.000032038,0.000014697,-0.000013510,-0.000037031},
{-0.000048641,-0.000088712,-0.000033077,-0.000053784,-0.000018938,-0.000029643,-0.000026817,0.000022592,0.000041448,0.000019886,0.000053389,0.000010453,0.000033031,0.000005150,0.000050386,0.000036885,0.000006672,0.000026081,0.000013846,-0.000012581,-0.000007896,-0.000028738,-0.000055822,-0.000011549},
{-0.000116962,-0.000076165,-0.000013297,-0.000026568,0.000023690,-0.000029802,-0.000006513,0.000048203,0.000046791,-0.000036218,0.000009397,0.000055104,0.000030949,0.000085714,-0.000000236,0.000030488,0.000020846,0.000000158,0.000003861,-0.000000108,0.000002227,-0.000062732,0.000021320,-0.000072541},
{0.000026941,0.000029916,-0.000000361,-0.000031720,-0.000035342,-0.000006620,0.000024460,0.000046295,0.000009657,0.000047802,0.000036766,0.000033704,0.000045118,0.000048010,0.000041293,0.000024889,0.000002340,-0.000002909,-0.000001755,0.000043606,0.000002145,-0.000050127,-0.000101032,-0.000144952},
{-0.000083055,-0.000015475,-0.000010130,-0.000009865,-0.000003074,0.000070146,0.000037020,0.000028519,0.000026474,0.000021037,0.000065351,0.000077585,0.000009793,0.000014138,0.000053459,0.000026674,0.000034571,0.000057485,0.000014018,0.000030224,-0.000045057,-0.000027463,-0.000002906,-0.000122312},
{-0.000126153,-0.000094738,-0.000049996,0.000005827,-0.000000553,-0.000047982,-0.000013648,0.000036760,0.000015682,0.000024387,0.000080520,0.000032411,0.000033099,0.000042709,0.000030787,0.000046307,0.000043307,0.000038292,-0.000044407,-0.000009650,-0.000030717,-0.000073266,-0.000051404,-0.000085777},
{-0.000066263,-0.000007797,-0.000063175,-0.000075905,-0.000046284,-0.000026541,-0.000027096,0.000006876,0.000004001,0.000046864,0.000077026,0.000038622,0.000036637,0.000053041,0.000059879,0.000024037,0.000040269,0.000035829,0.000014409,-0.000021246,-0.000015545,0.000000544,-0.000068165,-0.000005691},
{-0.000068571,-0.000013375,-0.000074588,-0.000060251,-0.000034331,0.000010459,0.000019786,0.000011763,-0.000018293,0.000020634,0.000026005,0.000033017,0.000015733,0.000027183,0.000068603,0.000019176,0.000012156,0.000018788,0.000004041,-0.000018538,-0.000015827,-0.000069563,-0.000081881,0.000037730},
{-0.000062347,-0.000041043,-0.000069742,-0.000044451,-0.000017406,-0.000016909,0.000030010,0.000005888,0.000023626,0.000003876,0.000014276,0.000054334,0.000021797,0.000035071,0.000025940,0.000084511,0.000038873,0.000041413,0.000002033,-0.000035482,-0.000010044,-0.000048393,0.000020930,-0.000125399},
{-0.000004176,-0.000109488,0.000058016,-0.000034500,0.000001588,-0.000000894,0.000011536,0.000048451,0.000042524,0.000047551,0.000057006,0.000074910,0.000060236,0.000019629,0.000021157,0.000044242,0.000053187,0.000051370,0.000003182,0.000021870,0.000008202,-0.000022771,-0.000031065,-0.000130827},
{-0.000126630,-0.000085562,0.000005438,-0.000025292,-0.000033151,0.000009874,0.000061728,-0.000009245,0.000090550,0.000027340,0.000046268,0.000043168,0.000050295,0.000040160,0.000041844,0.000019713,0.000000780,0.000047250,0.000010871,0.000001094,-0.000030358,-0.000002705,0.000026258,-0.000018298}};
const double rochcor2016::dcor_ma[16][24]={{0.000556908,0.000489167,0.000306383,0.000123116,0.000021051,-0.000037844,-0.000044616,-0.000010256,-0.000102276,-0.000063615,-0.000048814,-0.000081942,-0.000105530,-0.000061462,-0.000073305,-0.000072652,-0.000106002,-0.000083475,-0.000110261,-0.000098951,-0.000041897,-0.000008889,-0.000120512,-0.000064400},
{0.000712076,0.000431960,0.000234773,0.000137043,0.000073254,0.000017800,-0.000055247,-0.000014386,-0.000018637,-0.000029572,-0.000054882,0.000016137,-0.000052746,-0.000029180,-0.000034521,-0.000049151,-0.000046937,0.000015708,-0.000014246,-0.000000517,0.000061089,0.000125184,0.000096123,0.000134017},
{0.000622241,0.000404882,0.000214462,0.000074160,0.000012321,-0.000019197,-0.000047942,0.000005794,0.000008389,-0.000035701,-0.000031006,-0.000056535,-0.000017590,-0.000008856,-0.000001488,0.000015275,0.000011918,-0.000028714,0.000023161,0.000070813,0.000119909,0.000204355,0.000193911,0.000145410},
{0.000396189,0.000228578,0.000114770,0.000043916,0.000055402,-0.000000224,0.000024895,-0.000030286,0.000076127,0.000007664,0.000020565,0.000025926,0.000062534,0.000007063,0.000042346,0.000015492,0.000068116,0.000043814,0.000042762,0.000078294,0.000124956,0.000222366,0.000127133,0.000083680},
{0.000104531,-0.000062302,-0.000028271,-0.000031395,-0.000006579,-0.000028164,0.000020127,0.000080568,0.000031273,0.000033992,0.000014094,0.000038640,0.000029713,0.000029563,-0.000008630,-0.000013625,0.000041155,0.000020049,-0.000050434,0.000024284,0.000102907,0.000124815,0.000093971,0.000198383},
{-0.000279815,-0.000223238,-0.000135897,-0.000099091,0.000022150,0.000056450,0.000048006,0.000033380,0.000062803,0.000028792,0.000038775,0.000063343,0.000026631,0.000046369,0.000044505,0.000025858,0.000006928,-0.000005606,-0.000013274,0.000007134,0.000034667,0.000131577,0.000129393,0.000183426},
{-0.000453783,-0.000283982,-0.000222798,-0.000082714,0.000007996,-0.000003702,0.000054792,0.000057735,0.000074975,0.000044643,0.000031508,0.000060265,0.000023637,0.000015071,0.000088085,0.000052063,0.000039143,0.000046760,0.000060485,-0.000014826,0.000002997,0.000084192,0.000178869,0.000411081},
{-0.000572507,-0.000381834,-0.000262107,-0.000098672,-0.000071271,0.000039490,0.000041017,0.000059343,0.000064103,0.000052885,0.000025678,0.000067711,0.000061401,0.000046271,0.000087901,0.000102706,0.000078904,0.000093924,0.000043101,0.000046718,0.000002826,0.000029112,0.000191601,0.000241375},
{-0.000700582,-0.000417403,-0.000224117,-0.000133822,-0.000016940,0.000041680,0.000082540,0.000064506,0.000055486,0.000084566,0.000086626,0.000034194,0.000042207,0.000030671,0.000031695,0.000066675,0.000044895,0.000048345,0.000029229,0.000060708,0.000039166,0.000000523,0.000191400,0.000529561},
{-0.000536577,-0.000416291,-0.000177014,-0.000128351,0.000011630,0.000036918,0.000061900,0.000064590,0.000039146,0.000037149,0.000045566,0.000050267,0.000031432,0.000021776,0.000050605,0.000067536,0.000068109,0.000060888,0.000088174,0.000066355,0.000055128,0.000039753,0.000147766,0.000437222},
{-0.000494064,-0.000350122,-0.000148733,-0.000034508,-0.000052901,0.000010543,0.000011464,-0.000005041,-0.000021745,0.000003843,0.000046619,-0.000004135,0.000003059,0.000007397,0.000004411,0.000021288,0.000014516,-0.000006577,0.000023752,0.000021789,-0.000003405,-0.000000639,0.000003990,0.000254257},
{-0.000341356,-0.000221553,-0.000106099,0.000003352,-0.000074642,-0.000003840,0.000006318,-0.000003486,-0.000004858,-0.000009045,-0.000039877,-0.000051101,-0.000025086,-0.000033504,-0.000031066,-0.000035049,-0.000056197,-0.000020565,-0.000013361,-0.000066424,-0.000031425,-0.000135291,-0.000119037,0.000092077},
{0.000003382,0.000045726,0.000039982,-0.000008251,-0.000054503,0.000021336,0.000024861,0.000019098,-0.000025139,-0.000043782,-0.000038649,-0.000034211,-0.000053690,-0.000061295,-0.000072434,-0.000043325,-0.000062586,-0.000050130,-0.000103807,-0.000084021,-0.000084025,-0.000231467,-0.000164601,-0.000005652},
{0.000012823,0.000110438,0.000056694,0.000019169,-0.000015514,0.000008824,-0.000024372,-0.000024365,-0.000037023,-0.000033601,-0.000074663,-0.000050394,-0.000112892,-0.000090993,-0.000107716,-0.000101988,-0.000102668,-0.000121008,-0.000155400,-0.000116916,-0.000119987,-0.000217541,-0.000292550,-0.000191587},
{0.000202739,0.000331052,0.000146709,0.000041199,-0.000012170,-0.000006030,-0.000013575,-0.000056718,-0.000049560,-0.000034049,-0.000050949,-0.000076760,-0.000069585,-0.000077183,-0.000103220,-0.000116878,-0.000134832,-0.000133241,-0.000162649,-0.000206032,-0.000141273,-0.000245578,-0.000234064,-0.000214093},
{0.000391838,0.000376851,0.000265381,0.000108742,0.000010632,-0.000030404,-0.000030155,-0.000023742,-0.000068879,-0.000069930,-0.000056280,-0.000088198,-0.000102448,-0.000099130,-0.000085116,-0.000098113,-0.000101832,-0.000168402,-0.000193710,-0.000142061,-0.000128367,-0.000155151,-0.000187436,-0.000269257}};
const double rochcor2016::mcor_bf[16][24]={{-0.000073906,-0.000026373,0.000011154,-0.000028087,0.000014894,-0.000005632,0.000014939,0.000033670,0.000037597,0.000024160,0.000028904,0.000026547,0.000029251,0.000029758,0.000031586,0.000029658,0.000028093,0.000031337,0.000010676,0.000023227,-0.000007062,0.000004525,-0.000037187,-0.000126130},
{-0.000058494,-0.000046397,0.000008388,-0.000018280,0.000007728,-0.000005644,0.000038761,0.000021554,0.000032820,0.000030541,0.000031641,0.000055292,0.000040229,0.000022357,0.000042651,0.000048714,0.000031797,0.000012660,0.000010574,-0.000006233,-0.000014415,-0.000015206,-0.000034386,-0.000045461},
{-0.000023776,-0.000077819,-0.000037581,-0.000010994,-0.000010473,0.000003420,0.000020507,0.000014172,0.000016708,0.000034304,0.000023587,0.000041740,0.000047689,0.000053860,0.000029676,0.000012854,0.000028795,0.000029941,0.000008880,0.000006008,-0.000003655,0.000018402,-0.000000923,-0.000072493},
{-0.000115390,-0.000082583,-0.000026513,-0.000022054,0.000003920,0.000003048,0.000018591,0.000028105,0.000022480,0.000038505,0.000011746,0.000051687,0.000035185,0.000027194,0.000029634,0.000030534,0.000025734,0.000025192,-0.000005352,0.000015021,-0.000009313,-0.000013268,0.000023671,-0.000053944},
{-0.000114248,0.000013242,0.000000487,-0.000006103,0.000015691,0.000016843,0.000013985,0.000023589,0.000036387,0.000019709,0.000018961,0.000030191,0.000035634,0.000021206,0.000054005,0.000030102,0.000049855,0.000007071,0.000008309,-0.000008637,-0.000015440,-0.000011282,-0.000018861,-0.000073044},
{-0.000022308,-0.000031259,-0.000028919,-0.000021376,0.000002553,0.000026388,0.000040919,0.000021268,0.000035149,0.000029755,0.000039752,0.000034666,0.000042615,0.000054410,0.000024778,0.000020837,0.000021037,0.000020079,0.000019537,-0.000005287,-0.000014042,-0.000006251,-0.000004715,-0.000009624},
{-0.000085977,-0.000061818,-0.000006452,-0.000010559,-0.000007801,0.000004475,0.000044031,0.000030018,0.000036991,0.000034043,0.000023435,0.000030105,0.000041226,0.000027128,0.000033048,0.000033258,0.000029847,0.000031361,0.000015776,-0.000008806,-0.000000188,-0.000022146,-0.000056273,-0.000030435},
{-0.000070428,-0.000065521,0.000006432,-0.000018282,0.000020508,0.000025730,0.000011398,0.000024501,0.000024651,0.000034436,0.000038659,0.000058878,0.000040667,0.000048167,0.000034283,0.000043581,0.000047514,0.000018241,0.000015806,0.000014428,0.000002710,-0.000022286,0.000025847,-0.000016116},
{-0.000017430,-0.000006217,-0.000002092,0.000000010,0.000014414,0.000011523,0.000047346,0.000039481,0.000039789,0.000020087,0.000042647,0.000044399,0.000041487,0.000036048,0.000047171,0.000034861,0.000031810,0.000017367,0.000021982,0.000009525,0.000016082,-0.000015859,-0.000056219,-0.000015493},
{-0.000087439,-0.000006226,0.000000549,0.000007558,0.000010360,0.000048701,0.000056739,0.000029974,0.000041551,0.000036578,0.000050043,0.000049548,0.000049612,0.000060346,0.000040165,0.000045576,0.000027147,0.000045216,0.000029634,0.000014277,-0.000016278,-0.000010901,-0.000023024,-0.000103644},
{-0.000075349,-0.000039075,0.000009920,-0.000010612,0.000020944,0.000002882,0.000008265,0.000037226,0.000033441,0.000046785,0.000054938,0.000040337,0.000047263,0.000046296,0.000042359,0.000041295,0.000030452,0.000038331,-0.000005795,-0.000013729,-0.000013477,-0.000031324,-0.000005048,-0.000032305},
{-0.000058481,0.000042398,-0.000010623,0.000005309,-0.000001698,0.000029934,0.000027276,0.000021547,0.000033305,0.000046527,0.000044608,0.000064505,0.000053771,0.000029567,0.000064206,0.000022822,0.000011652,0.000036196,0.000034829,-0.000002034,-0.000010158,0.000002517,-0.000051290,-0.000016600},
{-0.000026359,-0.000062440,-0.000037761,-0.000009741,-0.000000945,0.000024298,0.000021905,0.000028091,0.000027396,0.000031602,0.000045756,0.000040176,0.000041948,0.000032612,0.000049582,0.000037266,0.000044394,0.000028625,-0.000004112,0.000009160,-0.000018711,-0.000004813,-0.000021551,-0.000080593},
{-0.000006483,-0.000014745,-0.000005663,-0.000020052,0.000015619,0.000005976,0.000040228,0.000047231,0.000033888,0.000028988,0.000024099,0.000039338,0.000050834,0.000049614,0.000038482,0.000040725,0.000039084,0.000022894,0.000017828,0.000010566,-0.000006231,0.000003257,-0.000047840,-0.000054957},
{-0.000031639,-0.000028231,-0.000019299,0.000013138,0.000016926,-0.000012089,0.000034799,0.000016258,0.000034768,0.000037831,0.000044691,0.000043993,0.000051364,0.000043884,0.000035127,0.000022406,0.000047201,0.000032145,0.000022337,-0.000004322,0.000000712,-0.000037450,-0.000040020,-0.000046347},
{-0.000023729,-0.000056482,-0.000009057,-0.000000080,-0.000006297,0.000000586,0.000036811,0.000037121,0.000043695,0.000040576,0.000033177,0.000032304,0.000032470,0.000026361,0.000031946,0.000031061,0.000017544,0.000038884,0.000014370,0.000013838,-0.000011193,-0.000019545,-0.000035112,-0.000065332}};
const double rochcor2016::mcor_ma[16][24]={{-0.000023443,-0.000021613,-0.000006275,-0.000015217,0.000027485,-0.000000867,-0.000012290,-0.000031785,-0.000045351,-0.000048588,-0.000028164,-0.000044818,-0.000040954,-0.000023772,-0.000047862,-0.000023115,-0.000021944,-0.000023690,-0.000022750,-0.000030967,-0.000022748,-0.000026510,-0.000090947,-0.000111039},
{-0.000037236,-0.000020605,-0.000039613,-0.000030202,0.000002486,-0.000016285,-0.000042075,-0.000047770,-0.000033468,-0.000030898,-0.000051356,-0.000022653,-0.000031610,-0.000031661,-0.000035772,-0.000029861,-0.000033902,-0.000018694,-0.000022619,0.000010700,-0.000007302,0.000020327,0.000047451,0.000084245},
{0.000036381,-0.000011693,-0.000009324,-0.000016574,-0.000032368,-0.000051592,-0.000063094,-0.000047354,-0.000025570,-0.000030553,-0.000031607,-0.000033158,-0.000023074,-0.000014119,-0.000030073,-0.000030137,-0.000028159,-0.000026531,0.000014544,0.000028999,0.000012452,0.000017561,0.000074194,0.000149829},
{-0.000062743,-0.000047240,-0.000072572,-0.000048097,-0.000033551,-0.000018664,-0.000042363,-0.000056835,-0.000017981,-0.000033908,-0.000012229,-0.000001609,-0.000011730,-0.000023849,-0.000013742,-0.000024708,-0.000002637,-0.000008916,0.000029715,0.000026836,0.000044973,0.000028505,0.000039085,0.000058755},
{-0.000014659,-0.000086395,-0.000020610,-0.000028394,-0.000000114,-0.000004222,-0.000015980,0.000000484,-0.000019618,-0.000023152,-0.000014119,-0.000021019,-0.000013208,-0.000006813,-0.000018401,-0.000002390,-0.000002213,0.000002377,0.000016003,0.000036261,0.000048255,0.000013251,0.000050874,0.000035987},
{0.000019158,-0.000024267,-0.000002332,-0.000013641,0.000017077,0.000004058,0.000005825,0.000006957,0.000002527,-0.000007243,0.000002056,-0.000005424,0.000001063,0.000006499,-0.000003537,0.000014347,-0.000012112,0.000003332,-0.000001796,-0.000007268,0.000003153,0.000002323,-0.000036462,-0.000026625},
{0.000144451,0.000040446,0.000051025,-0.000002506,0.000025215,0.000011643,-0.000005569,0.000017071,0.000015330,0.000010208,0.000011884,0.000001120,-0.000002761,0.000012184,0.000023548,0.000014030,0.000011140,0.000028578,-0.000010547,0.000003858,-0.000028778,-0.000019165,0.000002669,0.000042840},
{0.000134991,0.000076153,0.000041349,0.000039154,0.000022254,0.000013876,-0.000005929,0.000004892,0.000010760,0.000010958,0.000000462,0.000001342,0.000011489,0.000002065,0.000018213,0.000020111,0.000013577,0.000019062,-0.000002085,0.000020033,-0.000017516,-0.000022863,-0.000006544,-0.000010553},
{0.000058326,0.000029038,0.000062781,0.000022835,0.000028810,0.000001441,0.000010452,0.000000231,0.000018111,0.000019395,0.000020665,-0.000008032,-0.000003023,-0.000005737,-0.000007951,0.000014942,-0.000004340,0.000002211,0.000005768,0.000017501,0.000004491,0.000021617,0.000002757,0.000099101},
{-0.000044564,-0.000015425,0.000010716,-0.000001828,-0.000021556,-0.000012675,-0.000024507,-0.000021265,0.000019225,0.000007133,0.000008236,-0.000007657,0.000000583,-0.000008313,0.000004256,-0.000001674,0.000022862,0.000019117,0.000036227,0.000026594,0.000050509,0.000082173,0.000095916,0.000128702},
{-0.000069423,-0.000068800,-0.000043994,-0.000035181,-0.000025218,-0.000029780,-0.000029069,-0.000014138,-0.000020518,-0.000026698,-0.000004936,-0.000008268,0.000009029,0.000005064,0.000002226,0.000002528,0.000004380,-0.000004259,-0.000007239,0.000026900,0.000036889,0.000074634,0.000063150,0.000097311},
{-0.000091182,-0.000055884,-0.000039020,-0.000009940,-0.000048626,-0.000039848,-0.000031492,-0.000024041,-0.000021547,-0.000015960,-0.000036404,-0.000014533,-0.000001184,0.000019575,-0.000010022,0.000002957,0.000004195,0.000011908,0.000018377,0.000006377,0.000023653,0.000020336,0.000033025,0.000054058},
{0.000029892,-0.000016426,-0.000029611,-0.000021433,-0.000030662,-0.000013208,-0.000015199,-0.000022216,-0.000024421,-0.000017253,-0.000010315,-0.000008653,-0.000013531,-0.000016561,-0.000018654,-0.000020447,-0.000010750,0.000001038,-0.000001117,0.000011903,-0.000000431,-0.000002547,0.000045232,0.000030149},
{-0.000014288,-0.000019813,-0.000011290,-0.000014084,-0.000012251,-0.000034195,-0.000040764,-0.000029202,-0.000026877,-0.000019705,-0.000026366,-0.000023505,-0.000023769,-0.000010171,-0.000017702,-0.000035546,-0.000033123,-0.000009311,-0.000024644,-0.000022334,-0.000018923,-0.000049702,-0.000033104,-0.000078887},
{-0.000059049,-0.000023684,-0.000029329,-0.000043613,-0.000037631,-0.000032075,-0.000045474,-0.000029335,-0.000025609,-0.000026739,-0.000035717,-0.000038810,-0.000020242,-0.000020421,-0.000041136,-0.000052833,-0.000055565,-0.000042626,-0.000042316,-0.000018573,-0.000060807,-0.000077776,-0.000111705,-0.000087999},
{-0.000062553,-0.000036114,0.000001653,-0.000025387,-0.000020348,-0.000032136,-0.000048745,-0.000030958,-0.000023948,-0.000041669,-0.000030999,-0.000025915,-0.000038162,-0.000020317,-0.000022668,-0.000050408,-0.000045880,-0.000050271,-0.000064931,-0.000047194,-0.000039852,-0.000052093,-0.000083874,-0.000139368}};
//==========================================================================================================================
const double rochcor2016::dmavg[16][24]={{0.025514747,0.025244487,0.025375210,0.024886082,0.024842999,0.024571952,0.024651301,0.024778488,0.024962165,0.025202316,0.025104779,0.025236533,0.025242719,0.025148418,0.025157812,0.025032998,0.024888615,0.024611140,0.024660228,0.024717263,0.024773566,0.025173480,0.025299452,0.025601725},
{0.025972750,0.025291655,0.025611314,0.025036611,0.024771007,0.024743101,0.024745208,0.024979921,0.024833036,0.025159555,0.025279938,0.025177764,0.025331227,0.025239853,0.024880908,0.025088225,0.024738342,0.024700608,0.024702371,0.024653261,0.025026825,0.025247337,0.025762936,0.025866302},
{0.025538214,0.025472889,0.025027732,0.024933570,0.024898369,0.024704584,0.024769986,0.024949872,0.025035169,0.025114066,0.025321149,0.025410374,0.025508321,0.025027319,0.025071298,0.024805760,0.024819177,0.024871486,0.024645115,0.024453227,0.024826103,0.024749673,0.025547415,0.025902667},
{0.025501356,0.025298095,0.025054919,0.024891807,0.024650857,0.024689939,0.024983543,0.024973263,0.024980587,0.025130241,0.025088491,0.025271308,0.025504816,0.025214987,0.024956752,0.025043427,0.024958573,0.024561508,0.024572985,0.024533819,0.024913547,0.025247827,0.025890750,0.025768589},
{0.025762084,0.025396821,0.025119027,0.024780321,0.024739725,0.024630057,0.024925463,0.024799961,0.024993683,0.025111059,0.025162800,0.025471570,0.025338693,0.025269678,0.025024322,0.024992366,0.024895281,0.025001339,0.024692556,0.024833283,0.024831676,0.024940160,0.025280057,0.025357622},
{0.025554440,0.025728223,0.025142135,0.025060183,0.024660941,0.024776146,0.024731056,0.024943737,0.025032141,0.024880982,0.025166133,0.025299305,0.025322780,0.025246289,0.025196575,0.025009492,0.024872185,0.024701245,0.024673484,0.024686557,0.024904726,0.025216293,0.025102403,0.025844785},
{0.025769763,0.025610065,0.025014490,0.024854711,0.024636047,0.024589207,0.024759408,0.024775293,0.024737062,0.025303444,0.025286279,0.025244669,0.025212163,0.025262153,0.025100861,0.024882751,0.024947600,0.024731517,0.024672207,0.024897321,0.024852361,0.025252825,0.025677227,0.025581894},
{0.025461838,0.025708614,0.025028223,0.024922754,0.024827722,0.024557603,0.024660714,0.024691661,0.024982287,0.025060454,0.025290925,0.025463914,0.025088873,0.025120088,0.025127523,0.024925146,0.024856381,0.024696256,0.024707536,0.024676103,0.025026465,0.025147906,0.025706428,0.025660422},
{0.025709628,0.025339332,0.025397522,0.024944981,0.024793016,0.024788339,0.024627268,0.025000593,0.025073157,0.025063046,0.025242700,0.025387681,0.025425406,0.025403587,0.024972155,0.024847238,0.024764322,0.024791519,0.024734024,0.024682865,0.024933197,0.025452500,0.025900629,0.026113213},
{0.025716118,0.025137262,0.025055585,0.024940876,0.024894500,0.024656081,0.024511909,0.024716026,0.024941257,0.025017183,0.025204574,0.025314457,0.025385546,0.025160698,0.025078012,0.025114439,0.024901504,0.024695951,0.024666869,0.024798054,0.024769001,0.025240378,0.025302605,0.025707178},
{0.025965034,0.025084067,0.025240734,0.024869324,0.024972158,0.024850411,0.024860039,0.025126182,0.025126648,0.024990820,0.025390084,0.025357293,0.025337073,0.025340301,0.024968153,0.024862379,0.024511089,0.025151398,0.024830512,0.024753798,0.024712669,0.025091206,0.025547271,0.025974399},
{0.025724891,0.025716992,0.025093627,0.024895085,0.024677441,0.024763840,0.024780086,0.024953546,0.024911016,0.024867529,0.025334642,0.025177236,0.025269880,0.025107597,0.025208280,0.024850759,0.024872460,0.024743546,0.024715775,0.024670261,0.025074866,0.024940987,0.025350613,0.025752826},
{0.025693947,0.025569585,0.025226128,0.025073617,0.024767876,0.024952859,0.024790911,0.024923541,0.024964962,0.024926193,0.025088359,0.025279207,0.025241011,0.025455780,0.025373595,0.024875086,0.024770356,0.024908255,0.024642689,0.024871092,0.024866499,0.025102052,0.025659927,0.025700922},
{0.025794841,0.025636139,0.025073107,0.024749421,0.024779683,0.024618228,0.024793795,0.024936229,0.025000553,0.024846204,0.025189087,0.025203913,0.025177314,0.025189976,0.025073545,0.024808825,0.024898346,0.024631155,0.024865471,0.024837739,0.024861208,0.025134667,0.025344503,0.025742073},
{0.025774694,0.025974064,0.024958626,0.024829928,0.024734308,0.024583755,0.024757146,0.024804926,0.025091844,0.025043111,0.025193480,0.025378887,0.025267320,0.025174094,0.025277111,0.024861524,0.024956286,0.024652640,0.024641665,0.024946750,0.024864697,0.024985439,0.025430639,0.025668463},
{0.025574943,0.025635882,0.025202633,0.024822984,0.024872898,0.024805436,0.024834546,0.024897689,0.024941630,0.024991312,0.025209199,0.025272803,0.025264851,0.025039431,0.025034390,0.024765178,0.024758469,0.024712979,0.024730715,0.024615818,0.024789219,0.025107070,0.025630162,0.025758022}};
const double rochcor2016::dpavg[16][24]={{0.025771420,0.025181783,0.025423382,0.024834348,0.024799194,0.024732960,0.024836659,0.024841169,0.024849892,0.025075053,0.025260641,0.025305849,0.025425837,0.025191657,0.024989803,0.024929613,0.024890716,0.024830210,0.024683239,0.024827433,0.024868974,0.025109498,0.025472679,0.025823463},
{0.026133272,0.025377211,0.025214242,0.025276799,0.025010357,0.024495860,0.024511478,0.024699535,0.024859151,0.025258794,0.025221542,0.025341290,0.025409692,0.025237826,0.025074528,0.024953773,0.024755961,0.024769764,0.024772910,0.024788005,0.024839447,0.025207264,0.025342557,0.025737474},
{0.025565835,0.025299679,0.025102127,0.025007103,0.024664030,0.024717140,0.024654131,0.024799752,0.025049996,0.024940387,0.025304651,0.025328543,0.025374315,0.025185730,0.025031293,0.024862759,0.024672011,0.024758342,0.024687657,0.024626386,0.024786800,0.025141408,0.025820497,0.025804438},
{0.025647611,0.025237991,0.024927650,0.024734104,0.024885161,0.024790693,0.024765378,0.024853269,0.024974359,0.025141971,0.025140200,0.025438111,0.025560547,0.025044504,0.025038327,0.024818302,0.024794327,0.024638313,0.024513839,0.024758308,0.024737069,0.025223547,0.025618506,0.025662611},
{0.025838444,0.025363816,0.025271348,0.025114453,0.024627779,0.024609763,0.024808217,0.024762695,0.024869953,0.025089919,0.025424371,0.025229901,0.025510558,0.025325420,0.025026367,0.025050345,0.024858861,0.024577679,0.024872443,0.024770462,0.024688502,0.025028977,0.025541852,0.025691719},
{0.025719749,0.025438029,0.025254800,0.024910581,0.024729105,0.024566603,0.024771047,0.024830498,0.025039464,0.025189261,0.025138869,0.025495702,0.025314717,0.025263178,0.025041638,0.024730536,0.024823730,0.024467665,0.024556917,0.024863949,0.024874360,0.025469483,0.025525108,0.025642495},
{0.026064597,0.025736096,0.025296241,0.024808920,0.024988335,0.024821642,0.024766769,0.024703451,0.024914123,0.024997674,0.025394686,0.025332095,0.025308408,0.025217582,0.025068184,0.024931656,0.024952216,0.024769639,0.024657986,0.024887544,0.024876367,0.025384688,0.025491910,0.025775804},
{0.025606806,0.025658907,0.025437232,0.024967100,0.024892175,0.024710552,0.024527953,0.024962771,0.025134721,0.024982587,0.025184809,0.025401753,0.025412485,0.025082048,0.025075878,0.024784715,0.024968732,0.024346514,0.024756254,0.024885734,0.025009267,0.025330883,0.025521096,0.025849562},
{0.026149731,0.025610003,0.025575715,0.025071429,0.024856541,0.024731068,0.024803205,0.024753078,0.024923982,0.025189490,0.025181753,0.025204975,0.025478868,0.025365887,0.025293690,0.024800437,0.024708804,0.024787981,0.024758168,0.024838595,0.024838628,0.025111861,0.025767780,0.025906502},
{0.025701869,0.025564247,0.025401694,0.024910291,0.024676702,0.024922102,0.024738329,0.024866926,0.024854396,0.025030582,0.025139818,0.025301571,0.025387113,0.024982194,0.025023508,0.025044235,0.024830602,0.024706227,0.024647052,0.024722056,0.025032544,0.025065101,0.025458608,0.025821344},
{0.026014365,0.025337247,0.025280488,0.025051826,0.024983314,0.024637156,0.024761293,0.024710399,0.025017601,0.025050343,0.025488389,0.025595519,0.025144342,0.025231753,0.025012389,0.025095346,0.024569299,0.024931270,0.024772959,0.024786798,0.025136447,0.025273718,0.025737145,0.025753503},
{0.025891659,0.025624603,0.025152776,0.025037774,0.024835820,0.024820159,0.024675693,0.024875262,0.024910322,0.025134679,0.024932394,0.025251530,0.025592570,0.025344406,0.025112703,0.024884125,0.025046578,0.024885505,0.024450563,0.024956831,0.024793669,0.025202938,0.025653239,0.025779438},
{0.025719682,0.025405989,0.024976619,0.025005779,0.024955951,0.024488820,0.024616366,0.024634844,0.024991616,0.025121261,0.025346532,0.025507292,0.025491082,0.025374357,0.025285182,0.024882125,0.024928506,0.024817691,0.024477178,0.025001069,0.024987140,0.025520983,0.025568022,0.025665262},
{0.025940457,0.025652081,0.025318767,0.024759675,0.024839749,0.024802848,0.024682588,0.024776023,0.024885427,0.025069243,0.025264426,0.025266402,0.025272689,0.025266667,0.024881370,0.024895172,0.024770459,0.024783548,0.024614563,0.024820182,0.024988140,0.025331819,0.025518017,0.026044517},
{0.025848425,0.025330421,0.024995082,0.024886328,0.024730367,0.024656419,0.024710403,0.024953984,0.024838142,0.025077961,0.025084592,0.025230160,0.025451990,0.025268543,0.025046376,0.024933966,0.024939101,0.024815401,0.024876538,0.024834691,0.024812507,0.025307130,0.025595447,0.026048897},
{0.026037102,0.025392668,0.025222935,0.024863023,0.024601495,0.024666569,0.024703418,0.024726092,0.025023826,0.025095997,0.025088065,0.025382439,0.025561653,0.025168537,0.025128975,0.024968596,0.024828309,0.024744317,0.024888723,0.024739188,0.024980986,0.025280929,0.025209954,0.026135904}};
const double rochcor2016::mmavg[16][24]={{0.025466196,0.025122938,0.025025264,0.024780021,0.024578815,0.024586820,0.024597202,0.024913100,0.025063961,0.025249353,0.025345327,0.025403634,0.025434288,0.025351078,0.025204750,0.025001380,0.024811333,0.024714825,0.024722523,0.024760266,0.024735358,0.024923196,0.025157620,0.025524539},
{0.025399815,0.025245061,0.024976567,0.024782695,0.024639723,0.024648099,0.024844683,0.024852993,0.025075024,0.025174865,0.025318854,0.025461046,0.025502136,0.025389699,0.025232719,0.024952927,0.024842211,0.024634950,0.024616656,0.024625946,0.024616409,0.024958849,0.025130727,0.025424759},
{0.025283114,0.025253459,0.024895500,0.024770318,0.024654754,0.024684202,0.024768297,0.024984895,0.025058950,0.025125470,0.025291499,0.025461298,0.025462042,0.025321916,0.025115195,0.024962071,0.024747409,0.024684027,0.024557414,0.024561530,0.024754367,0.025066678,0.025159583,0.025573046},
{0.025432269,0.025258186,0.025066734,0.024664239,0.024662704,0.024549835,0.024641435,0.024795229,0.024850306,0.025228784,0.025442461,0.025548991,0.025550764,0.025309058,0.025315088,0.024850306,0.024792690,0.024696687,0.024669616,0.024691741,0.024719337,0.024923236,0.025167326,0.025588430},
{0.025453000,0.025247128,0.024845955,0.024679636,0.024673697,0.024650670,0.024786290,0.024897008,0.025080176,0.025190895,0.025339198,0.025434166,0.025449427,0.025298201,0.025153960,0.025064727,0.024848215,0.024781376,0.024722093,0.024533901,0.024628737,0.024953481,0.025150767,0.025433868},
{0.025535245,0.025254549,0.024883923,0.024738870,0.024669841,0.024670233,0.024744621,0.024690933,0.024889432,0.025269988,0.025262424,0.025377511,0.025482409,0.025181426,0.025150092,0.024881802,0.024899851,0.024747850,0.024680020,0.024606859,0.024753979,0.024941359,0.025220847,0.025564201},
{0.025614364,0.025080637,0.025007514,0.024761509,0.024636671,0.024583189,0.024693433,0.024732701,0.024959951,0.025166522,0.025353069,0.025391802,0.025561851,0.025299919,0.025161949,0.024924189,0.024951799,0.024678463,0.024737622,0.024698676,0.024839744,0.024912180,0.025176955,0.025442404},
{0.025602117,0.025201744,0.024948148,0.024821980,0.024752693,0.024579831,0.024811643,0.024841822,0.024980087,0.025097331,0.025281450,0.025404421,0.025507415,0.025300872,0.025224356,0.024988656,0.024794763,0.024749662,0.024697976,0.024695865,0.024811227,0.024952775,0.025263502,0.025666016},
{0.025582944,0.025326985,0.024968560,0.024943120,0.024715383,0.024653732,0.024704091,0.024829365,0.025004079,0.025213071,0.025202428,0.025313130,0.025310893,0.025320427,0.025083841,0.025022775,0.025067664,0.024711245,0.024642681,0.024895840,0.024840859,0.025061733,0.025392127,0.025527417},
{0.025619495,0.025184593,0.024972319,0.024762586,0.024781355,0.024776999,0.024828368,0.024817941,0.024951597,0.025186206,0.025202701,0.025404692,0.025380189,0.025356352,0.025132908,0.024949623,0.024848230,0.024752202,0.024744820,0.024735480,0.024768591,0.024963889,0.025238737,0.025407487},
{0.025387391,0.025306374,0.025179183,0.024880219,0.024701643,0.024668262,0.024683513,0.024890561,0.024965073,0.025206692,0.025436952,0.025361985,0.025434897,0.025271595,0.025112001,0.024988996,0.024872643,0.024805743,0.024613213,0.024666358,0.024768360,0.024937195,0.025134252,0.025607679},
{0.025514661,0.025384648,0.025073609,0.024672828,0.024670674,0.024741456,0.024760000,0.024820551,0.024938499,0.025144016,0.025367973,0.025425244,0.025415157,0.025265140,0.025101161,0.025017371,0.024975425,0.024831307,0.024665309,0.024697605,0.024750273,0.024889074,0.025246422,0.025646900},
{0.025489815,0.025239734,0.025049393,0.024753709,0.024687205,0.024661541,0.024705879,0.024809833,0.025005302,0.025224292,0.025339942,0.025361053,0.025379839,0.025466181,0.025141084,0.024971466,0.024940250,0.024678602,0.024631176,0.024677586,0.024818921,0.025016355,0.025277280,0.025372580},
{0.025644427,0.025316076,0.024931738,0.024708928,0.024706172,0.024709555,0.024728919,0.024857516,0.024930000,0.025056458,0.025269570,0.025415867,0.025393694,0.025269888,0.025058410,0.024965484,0.024816950,0.024736783,0.024594109,0.024555656,0.024790235,0.024997753,0.025212722,0.025430428},
{0.025466409,0.025241941,0.025010704,0.024800629,0.024737480,0.024716502,0.024781752,0.024821627,0.025018269,0.025224845,0.025379870,0.025322001,0.025347523,0.025307613,0.025116170,0.024992164,0.024929260,0.024722311,0.024711404,0.024657364,0.024866414,0.024954171,0.025251732,0.025569360},
{0.025576706,0.025321529,0.024979487,0.024789261,0.024640869,0.024712814,0.024698377,0.024738943,0.024959860,0.025269234,0.025220149,0.025356642,0.025415967,0.025269912,0.025158133,0.024927397,0.024952108,0.024749190,0.024571358,0.024671607,0.024739366,0.024951687,0.025277645,0.025557489}};
const double rochcor2016::mpavg[16][24]={{0.025538304,0.025210470,0.025071810,0.024751018,0.024753203,0.024679728,0.024692304,0.024873261,0.025133714,0.025152613,0.025334974,0.025487893,0.025435792,0.025394133,0.025195430,0.024950701,0.024950935,0.024786291,0.024772425,0.024767838,0.024842997,0.025095254,0.025350025,0.025492948},
{0.025457752,0.025340149,0.024987490,0.024686169,0.024705912,0.024646043,0.024786182,0.024878913,0.025050418,0.025180775,0.025305968,0.025493757,0.025502201,0.025304419,0.025270407,0.024959013,0.024775367,0.024708368,0.024665670,0.024717181,0.024838725,0.024906784,0.025175534,0.025704679},
{0.025541229,0.025120690,0.024979479,0.024818051,0.024635796,0.024705883,0.024668634,0.024949995,0.025018112,0.025128268,0.025305502,0.025448466,0.025496500,0.025372872,0.025311282,0.025014168,0.024710043,0.024690330,0.024557745,0.024695952,0.024747478,0.025107956,0.025375199,0.025527162},
{0.025592877,0.025312336,0.025081785,0.024745754,0.024726004,0.024645765,0.024815134,0.024910297,0.025022890,0.025172216,0.025324646,0.025523292,0.025451044,0.025444440,0.025174274,0.025051101,0.024917628,0.024763704,0.024638216,0.024749943,0.024790020,0.024870908,0.025301761,0.025463393},
{0.025687894,0.025361347,0.024997790,0.024820043,0.024626578,0.024650239,0.024717836,0.024909895,0.025031858,0.025153397,0.025370252,0.025340834,0.025498632,0.025396340,0.025094416,0.024946606,0.024853182,0.024805172,0.024689336,0.024579847,0.024792614,0.025007708,0.025427402,0.025502370},
{0.025592847,0.025143851,0.025014785,0.024815074,0.024663231,0.024551208,0.024796224,0.024823588,0.025073666,0.025084303,0.025372169,0.025440690,0.025412445,0.025300235,0.025185862,0.024967600,0.024857202,0.024715620,0.024652499,0.024640907,0.024813905,0.025027726,0.025366435,0.025676178},
{0.025587390,0.025212751,0.025066389,0.024776367,0.024788945,0.024762974,0.024725782,0.024936774,0.025046456,0.025216219,0.025280837,0.025422695,0.025495470,0.025379474,0.025076478,0.025096181,0.024834644,0.024672249,0.024673643,0.024684502,0.024877713,0.025025452,0.025291780,0.025713052},
{0.025704180,0.025273005,0.024920065,0.024723313,0.024666907,0.024726142,0.024601390,0.024756828,0.024976688,0.025158527,0.025320943,0.025426946,0.025444243,0.025325224,0.025166460,0.025022243,0.024755834,0.024804997,0.024699201,0.024721674,0.024732520,0.024963133,0.025389716,0.025597996},
{0.025708038,0.025445268,0.024991427,0.024729529,0.024733486,0.024649330,0.024738214,0.024916925,0.025030657,0.025178939,0.025421625,0.025439420,0.025374963,0.025361078,0.024990838,0.024903057,0.024803987,0.024691531,0.024644919,0.024618918,0.024818824,0.024944203,0.025274580,0.025784159},
{0.025511517,0.025342299,0.025064892,0.024884279,0.024687463,0.024689109,0.024773645,0.024830129,0.025040004,0.025138296,0.025348465,0.025451312,0.025555596,0.025232161,0.025176780,0.025050930,0.024829494,0.024727578,0.024662556,0.024730912,0.024944963,0.025174079,0.025415303,0.025446218},
{0.025515922,0.025444051,0.025136660,0.024889485,0.024594080,0.024672544,0.024729655,0.024802106,0.024959462,0.025043006,0.025430970,0.025400465,0.025438403,0.025384490,0.025083660,0.025027980,0.024958916,0.024689051,0.024676827,0.024682475,0.024795236,0.024989307,0.025301793,0.025389935},
{0.025532107,0.025371247,0.025047262,0.024834661,0.024571692,0.024663626,0.024582441,0.024783958,0.025006421,0.025181581,0.025180766,0.025454416,0.025533708,0.025347261,0.025171821,0.024843862,0.024780503,0.024771201,0.024691290,0.024548978,0.024791818,0.025023684,0.025040923,0.025663287},
{0.025688215,0.025354363,0.025151170,0.024766412,0.024651997,0.024778818,0.024716901,0.024857870,0.025012295,0.025154491,0.025309996,0.025454089,0.025441263,0.025356303,0.025231452,0.024976645,0.024915444,0.024778566,0.024707150,0.024794848,0.024841499,0.025084719,0.025272567,0.025495275},
{0.025627153,0.025353950,0.025073283,0.024833411,0.024768416,0.024660020,0.024766466,0.024806310,0.024975781,0.025167055,0.025273328,0.025524820,0.025510302,0.025265650,0.025180639,0.024953648,0.024813589,0.024693655,0.024678608,0.024825005,0.024835524,0.025007752,0.025310179,0.025662058},
{0.025543278,0.025352553,0.025114460,0.024851604,0.024694425,0.024683019,0.024760543,0.024872476,0.024966116,0.025152583,0.025316902,0.025434533,0.025449727,0.025210237,0.025145486,0.024993078,0.024895871,0.024632148,0.024603344,0.024770283,0.024738406,0.025041200,0.025261403,0.025576251},
{0.025808073,0.025398050,0.025114677,0.024878910,0.024727106,0.024537901,0.024898485,0.024821880,0.025044207,0.025083612,0.025437736,0.025475730,0.025550718,0.025372029,0.025186983,0.025026525,0.024902707,0.024781958,0.024587188,0.024648412,0.024720670,0.025066575,0.025374582,0.025659663}};
//==========================================================================================================================
const double rochcor2016::dcor_bfer[16][24]={{0.000119612,0.000113702,0.000080013,0.000075369,0.000078105,0.000074931,0.000072932,0.000070517,0.000068008,0.000067778,0.000068656,0.000067960,0.000068222,0.000068665,0.000067898,0.000068889,0.000071453,0.000073457,0.000076188,0.000078708,0.000074391,0.000080328,0.000111562,0.000117979},
{0.000120958,0.000111988,0.000080854,0.000075329,0.000077794,0.000076762,0.000072459,0.000070652,0.000068923,0.000068130,0.000068393,0.000068514,0.000067821,0.000068485,0.000068699,0.000068614,0.000070365,0.000072252,0.000074739,0.000077818,0.000074212,0.000080510,0.000112263,0.000119880},
{0.000123751,0.000113473,0.000082493,0.000075587,0.000079524,0.000075397,0.000074613,0.000071751,0.000069685,0.000068670,0.000069551,0.000069511,0.000068336,0.000070109,0.000068251,0.000068981,0.000071562,0.000074352,0.000075046,0.000079001,0.000074043,0.000080320,0.000111904,0.000122507},
{0.000120674,0.000112083,0.000080808,0.000075134,0.000078766,0.000076232,0.000073226,0.000072779,0.000068871,0.000069227,0.000070376,0.000069108,0.000068678,0.000070515,0.000067990,0.000069197,0.000073700,0.000073094,0.000075788,0.000079394,0.000074697,0.000080814,0.000112779,0.000121966},
{0.000121133,0.000112403,0.000080338,0.000073867,0.000077967,0.000075465,0.000074159,0.000071646,0.000070183,0.000069326,0.000071373,0.000069532,0.000069333,0.000070160,0.000068028,0.000070659,0.000072699,0.000078266,0.000077295,0.000078877,0.000074245,0.000081128,0.000111634,0.000120744},
{0.000118069,0.000110117,0.000080231,0.000075720,0.000077500,0.000074642,0.000072946,0.000070350,0.000068203,0.000067720,0.000069185,0.000068350,0.000068196,0.000068981,0.000067631,0.000067977,0.000071473,0.000073145,0.000074213,0.000077892,0.000074566,0.000080392,0.000111897,0.000122203},
{0.000119816,0.000112502,0.000081096,0.000075144,0.000077969,0.000074779,0.000072388,0.000070660,0.000067896,0.000068407,0.000069811,0.000068917,0.000068991,0.000068573,0.000067325,0.000068685,0.000071354,0.000072535,0.000075089,0.000077949,0.000074732,0.000080809,0.000110987,0.000119978},
{0.000119298,0.000113200,0.000080885,0.000075511,0.000078835,0.000074583,0.000073392,0.000071011,0.000069908,0.000067275,0.000069409,0.000068550,0.000067487,0.000069545,0.000067874,0.000069013,0.000071777,0.000073492,0.000074650,0.000078369,0.000074366,0.000079422,0.000112050,0.000118109},
{0.000117654,0.000113807,0.000080801,0.000075121,0.000077957,0.000075212,0.000071950,0.000071507,0.000068371,0.000067568,0.000068807,0.000068001,0.000068581,0.000070042,0.000067286,0.000068052,0.000070616,0.000071988,0.000074716,0.000077704,0.000074256,0.000080508,0.000110649,0.000119343},
{0.000120334,0.000113258,0.000081010,0.000075371,0.000079677,0.000073836,0.000072954,0.000072811,0.000068555,0.000067546,0.000069956,0.000068182,0.000068386,0.000067924,0.000067612,0.000069205,0.000070525,0.000072762,0.000075327,0.000077940,0.000074095,0.000080031,0.000111773,0.000119050},
{0.000122773,0.000114301,0.000080932,0.000075356,0.000077988,0.000074087,0.000074303,0.000074865,0.000068674,0.000067542,0.000080540,0.000068578,0.000068271,0.000068264,0.000068232,0.000068172,0.000069834,0.000072635,0.000074803,0.000077973,0.000074332,0.000080811,0.000113922,0.000120481},
{0.000119160,0.000113269,0.000080779,0.000073830,0.000078604,0.000075862,0.000071882,0.000072236,0.000068554,0.000067804,0.000071731,0.000068437,0.000068399,0.000080011,0.000067975,0.000068195,0.000071878,0.000072348,0.000075540,0.000078974,0.000075513,0.000078998,0.000112238,0.000118718},
{0.000119911,0.000111616,0.000079196,0.000074342,0.000078305,0.000074901,0.000072846,0.000071928,0.000068997,0.000068590,0.000069793,0.000069081,0.000069362,0.000083918,0.000069225,0.000069524,0.000073143,0.000074476,0.000076123,0.000079588,0.000075061,0.000080660,0.000113418,0.000120248},
{0.000117903,0.000111899,0.000079539,0.000074454,0.000078588,0.000074495,0.000071919,0.000071071,0.000068276,0.000067296,0.000067644,0.000067812,0.000068622,0.000068208,0.000067293,0.000068968,0.000070354,0.000072776,0.000074058,0.000078409,0.000074728,0.000081616,0.000112625,0.000121614},
{0.000118530,0.000113448,0.000081706,0.000074595,0.000077928,0.000074540,0.000073386,0.000071299,0.000069139,0.000068376,0.000068592,0.000068470,0.000068287,0.000067973,0.000067456,0.000068281,0.000070882,0.000072390,0.000077504,0.000078849,0.000076781,0.000080029,0.000111701,0.000120334},
{0.000119924,0.000114300,0.000081271,0.000075646,0.000077766,0.000074579,0.000072920,0.000071324,0.000068642,0.000068170,0.000069336,0.000068777,0.000068503,0.000068267,0.000067747,0.000068656,0.000070961,0.000073218,0.000074989,0.000078007,0.000073559,0.000080515,0.000112409,0.000119249}};
const double rochcor2016::dcor_maer[16][24]={{0.000119612,0.000113702,0.000080013,0.000075369,0.000078105,0.000074931,0.000072932,0.000070517,0.000068008,0.000067778,0.000068656,0.000067960,0.000068222,0.000068665,0.000067898,0.000068889,0.000071453,0.000073457,0.000076188,0.000078708,0.000074391,0.000080328,0.000111562,0.000117979},
{0.000120958,0.000111988,0.000080854,0.000075329,0.000077794,0.000076762,0.000072459,0.000070652,0.000068923,0.000068130,0.000068393,0.000068514,0.000067821,0.000068485,0.000068699,0.000068614,0.000070365,0.000072252,0.000074739,0.000077818,0.000074212,0.000080510,0.000112263,0.000119880},
{0.000123751,0.000113473,0.000082493,0.000075587,0.000079524,0.000075397,0.000074613,0.000071751,0.000069685,0.000068670,0.000069551,0.000069511,0.000068336,0.000070109,0.000068251,0.000068981,0.000071562,0.000074352,0.000075046,0.000079001,0.000074043,0.000080320,0.000111904,0.000122507},
{0.000120674,0.000112083,0.000080808,0.000075134,0.000078766,0.000076232,0.000073226,0.000072779,0.000068871,0.000069227,0.000070376,0.000069108,0.000068678,0.000070515,0.000067990,0.000069197,0.000073700,0.000073094,0.000075788,0.000079394,0.000074697,0.000080814,0.000112779,0.000121966},
{0.000121133,0.000112403,0.000080338,0.000073867,0.000077967,0.000075465,0.000074159,0.000071646,0.000070183,0.000069326,0.000071373,0.000069532,0.000069333,0.000070160,0.000068028,0.000070659,0.000072699,0.000078266,0.000077295,0.000078877,0.000074245,0.000081128,0.000111634,0.000120744},
{0.000118069,0.000110117,0.000080231,0.000075720,0.000077500,0.000074642,0.000072946,0.000070350,0.000068203,0.000067720,0.000069185,0.000068350,0.000068196,0.000068981,0.000067631,0.000067977,0.000071473,0.000073145,0.000074213,0.000077892,0.000074566,0.000080392,0.000111897,0.000122203},
{0.000119816,0.000112502,0.000081096,0.000075144,0.000077969,0.000074779,0.000072388,0.000070660,0.000067896,0.000068407,0.000069811,0.000068917,0.000068991,0.000068573,0.000067325,0.000068685,0.000071354,0.000072535,0.000075089,0.000077949,0.000074732,0.000080809,0.000110987,0.000119978},
{0.000119298,0.000113200,0.000080885,0.000075511,0.000078835,0.000074583,0.000073392,0.000071011,0.000069908,0.000067275,0.000069409,0.000068550,0.000067487,0.000069545,0.000067874,0.000069013,0.000071777,0.000073492,0.000074650,0.000078369,0.000074366,0.000079422,0.000112050,0.000118109},
{0.000117654,0.000113807,0.000080801,0.000075121,0.000077957,0.000075212,0.000071950,0.000071507,0.000068371,0.000067568,0.000068807,0.000068001,0.000068581,0.000070042,0.000067286,0.000068052,0.000070616,0.000071988,0.000074716,0.000077704,0.000074256,0.000080508,0.000110649,0.000119343},
{0.000120334,0.000113258,0.000081010,0.000075371,0.000079677,0.000073836,0.000072954,0.000072811,0.000068555,0.000067546,0.000069956,0.000068182,0.000068386,0.000067924,0.000067612,0.000069205,0.000070525,0.000072762,0.000075327,0.000077940,0.000074095,0.000080031,0.000111773,0.000119050},
{0.000122773,0.000114301,0.000080932,0.000075356,0.000077988,0.000074087,0.000074303,0.000074865,0.000068674,0.000067542,0.000080540,0.000068578,0.000068271,0.000068264,0.000068232,0.000068172,0.000069834,0.000072635,0.000074803,0.000077973,0.000074332,0.000080811,0.000113922,0.000120481},
{0.000119160,0.000113269,0.000080779,0.000073830,0.000078604,0.000075862,0.000071882,0.000072236,0.000068554,0.000067804,0.000071731,0.000068437,0.000068399,0.000080011,0.000067975,0.000068195,0.000071878,0.000072348,0.000075540,0.000078974,0.000075513,0.000078998,0.000112238,0.000118718},
{0.000119911,0.000111616,0.000079196,0.000074342,0.000078305,0.000074901,0.000072846,0.000071928,0.000068997,0.000068590,0.000069793,0.000069081,0.000069362,0.000083918,0.000069225,0.000069524,0.000073143,0.000074476,0.000076123,0.000079588,0.000075061,0.000080660,0.000113418,0.000120248},
{0.000117903,0.000111899,0.000079539,0.000074454,0.000078588,0.000074495,0.000071919,0.000071071,0.000068276,0.000067296,0.000067644,0.000067812,0.000068622,0.000068208,0.000067293,0.000068968,0.000070354,0.000072776,0.000074058,0.000078409,0.000074728,0.000081616,0.000112625,0.000121614},
{0.000118530,0.000113448,0.000081706,0.000074595,0.000077928,0.000074540,0.000073386,0.000071299,0.000069139,0.000068376,0.000068592,0.000068470,0.000068287,0.000067973,0.000067456,0.000068281,0.000070882,0.000072390,0.000077504,0.000078849,0.000076781,0.000080029,0.000111701,0.000120334},
{0.000119924,0.000114300,0.000081271,0.000075646,0.000077766,0.000074579,0.000072920,0.000071324,0.000068642,0.000068170,0.000069336,0.000068777,0.000068503,0.000068267,0.000067747,0.000068656,0.000070961,0.000073218,0.000074989,0.000078007,0.000073559,0.000080515,0.000112409,0.000119249}};
const double rochcor2016::mcor_bfer[16][24]={{0.000092771,0.000088681,0.000064113,0.000060875,0.000063784,0.000060757,0.000058737,0.000058439,0.000056068,0.000055746,0.000056529,0.000056325,0.000055354,0.000055880,0.000055516,0.000056643,0.000058242,0.000058987,0.000061579,0.000063931,0.000060212,0.000064048,0.000088597,0.000093395},
{0.000093563,0.000088591,0.000064854,0.000060252,0.000063041,0.000062352,0.000059192,0.000057830,0.000056494,0.000055672,0.000056436,0.000055954,0.000055699,0.000055803,0.000056584,0.000055966,0.000058072,0.000058751,0.000061248,0.000063644,0.000060568,0.000064587,0.000088141,0.000092461},
{0.000093594,0.000088036,0.000065099,0.000060793,0.000063858,0.000061370,0.000059617,0.000058115,0.000056940,0.000055523,0.000056469,0.000056281,0.000056254,0.000056839,0.000056135,0.000056881,0.000058625,0.000060199,0.000061115,0.000063776,0.000059799,0.000064637,0.000087995,0.000093325},
{0.000094472,0.000089567,0.000064256,0.000059783,0.000064088,0.000061430,0.000060486,0.000058749,0.000056632,0.000056021,0.000057022,0.000056418,0.000055873,0.000056921,0.000055982,0.000056197,0.000058489,0.000059275,0.000061465,0.000064259,0.000061088,0.000064946,0.000087700,0.000093951},
{0.000094096,0.000088753,0.000064382,0.000060243,0.000063425,0.000061267,0.000059641,0.000057986,0.000056863,0.000056210,0.000057467,0.000056430,0.000056141,0.000056788,0.000056093,0.000057394,0.000059105,0.000059621,0.000061768,0.000064246,0.000060079,0.000064821,0.000087804,0.000093154},
{0.000094242,0.000087793,0.000065278,0.000060948,0.000063534,0.000061155,0.000059168,0.000057102,0.000055571,0.000055832,0.000055795,0.000055274,0.000055794,0.000056329,0.000055240,0.000055893,0.000057847,0.000058561,0.000061161,0.000063502,0.000059630,0.000064702,0.000087976,0.000093466},
{0.000093348,0.000088973,0.000064695,0.000060570,0.000063601,0.000060769,0.000058725,0.000058291,0.000055756,0.000055528,0.000056417,0.000055487,0.000056320,0.000055428,0.000055252,0.000056598,0.000057784,0.000059051,0.000061332,0.000062863,0.000060086,0.000065672,0.000088446,0.000093928},
{0.000093845,0.000089177,0.000065064,0.000060850,0.000063316,0.000060706,0.000059984,0.000058855,0.000056718,0.000055658,0.000056853,0.000055549,0.000055543,0.000056404,0.000055099,0.000056686,0.000058326,0.000059746,0.000061121,0.000063634,0.000060710,0.000064001,0.000088762,0.000093872},
{0.000092051,0.000089961,0.000064671,0.000060256,0.000063702,0.000060022,0.000058830,0.000058471,0.000056187,0.000055920,0.000056371,0.000056151,0.000055486,0.000056371,0.000055819,0.000056061,0.000058455,0.000059053,0.000060820,0.000063608,0.000060404,0.000064592,0.000088213,0.000092383},
{0.000094503,0.000088789,0.000064938,0.000060152,0.000063596,0.000060065,0.000058868,0.000057574,0.000056526,0.000055224,0.000056850,0.000055708,0.000055812,0.000055300,0.000055363,0.000056369,0.000057674,0.000058786,0.000060327,0.000064925,0.000059715,0.000064487,0.000088023,0.000092915},
{0.000091884,0.000087829,0.000064524,0.000060502,0.000063951,0.000060595,0.000059026,0.000058321,0.000055742,0.000055849,0.000065127,0.000055998,0.000056541,0.000055918,0.000055983,0.000056351,0.000057704,0.000059458,0.000061382,0.000063682,0.000059858,0.000064304,0.000088452,0.000093440},
{0.000094635,0.000089193,0.000064480,0.000059863,0.000063777,0.000061031,0.000059089,0.000058422,0.000056111,0.000055274,0.000058801,0.000056008,0.000055804,0.000064463,0.000055746,0.000056346,0.000058405,0.000059016,0.000060737,0.000063118,0.000060503,0.000063629,0.000088914,0.000094458},
{0.000092984,0.000087367,0.000064129,0.000060358,0.000063444,0.000061010,0.000058796,0.000057796,0.000055837,0.000055604,0.000056122,0.000055881,0.000056466,0.000064221,0.000055378,0.000055554,0.000058292,0.000059374,0.000061235,0.000063286,0.000060584,0.000064208,0.000089445,0.000092198},
{0.000093410,0.000090165,0.000064369,0.000060581,0.000064754,0.000060840,0.000059079,0.000057806,0.000056629,0.000055231,0.000055626,0.000055611,0.000056277,0.000056054,0.000055696,0.000055959,0.000057534,0.000059375,0.000060875,0.000064051,0.000060600,0.000065185,0.000090197,0.000092305},
{0.000092951,0.000089684,0.000065060,0.000060192,0.000063226,0.000060911,0.000059121,0.000058183,0.000056123,0.000055300,0.000055318,0.000055593,0.000056151,0.000055571,0.000055849,0.000056239,0.000058445,0.000059039,0.000061220,0.000063110,0.000060861,0.000064883,0.000088872,0.000093126},
{0.000093221,0.000090580,0.000063956,0.000060185,0.000064210,0.000061402,0.000059086,0.000058511,0.000056197,0.000055215,0.000055952,0.000056225,0.000056199,0.000056145,0.000055393,0.000056357,0.000058458,0.000059947,0.000060960,0.000063178,0.000060418,0.000064427,0.000089757,0.000093307}};
const double rochcor2016::mcor_maer[16][24]={{0.000092771,0.000088681,0.000064113,0.000060875,0.000063784,0.000060757,0.000058737,0.000058439,0.000056068,0.000055746,0.000056529,0.000056325,0.000055354,0.000055880,0.000055516,0.000056643,0.000058242,0.000058987,0.000061579,0.000063931,0.000060212,0.000064048,0.000088597,0.000093395},
{0.000093563,0.000088591,0.000064854,0.000060252,0.000063041,0.000062352,0.000059192,0.000057830,0.000056494,0.000055672,0.000056436,0.000055954,0.000055699,0.000055803,0.000056584,0.000055966,0.000058072,0.000058751,0.000061248,0.000063644,0.000060568,0.000064587,0.000088141,0.000092461},
{0.000093594,0.000088036,0.000065099,0.000060793,0.000063858,0.000061370,0.000059617,0.000058115,0.000056940,0.000055523,0.000056469,0.000056281,0.000056254,0.000056839,0.000056135,0.000056881,0.000058625,0.000060199,0.000061115,0.000063776,0.000059799,0.000064637,0.000087995,0.000093325},
{0.000094472,0.000089567,0.000064256,0.000059783,0.000064088,0.000061430,0.000060486,0.000058749,0.000056632,0.000056021,0.000057022,0.000056418,0.000055873,0.000056921,0.000055982,0.000056197,0.000058489,0.000059275,0.000061465,0.000064259,0.000061088,0.000064946,0.000087700,0.000093951},
{0.000094096,0.000088753,0.000064382,0.000060243,0.000063425,0.000061267,0.000059641,0.000057986,0.000056863,0.000056210,0.000057467,0.000056430,0.000056141,0.000056788,0.000056093,0.000057394,0.000059105,0.000059621,0.000061768,0.000064246,0.000060079,0.000064821,0.000087804,0.000093154},
{0.000094242,0.000087793,0.000065278,0.000060948,0.000063534,0.000061155,0.000059168,0.000057102,0.000055571,0.000055832,0.000055795,0.000055274,0.000055794,0.000056329,0.000055240,0.000055893,0.000057847,0.000058561,0.000061161,0.000063502,0.000059630,0.000064702,0.000087976,0.000093466},
{0.000093348,0.000088973,0.000064695,0.000060570,0.000063601,0.000060769,0.000058725,0.000058291,0.000055756,0.000055528,0.000056417,0.000055487,0.000056320,0.000055428,0.000055252,0.000056598,0.000057784,0.000059051,0.000061332,0.000062863,0.000060086,0.000065672,0.000088446,0.000093928},
{0.000093845,0.000089177,0.000065064,0.000060850,0.000063316,0.000060706,0.000059984,0.000058855,0.000056718,0.000055658,0.000056853,0.000055549,0.000055543,0.000056404,0.000055099,0.000056686,0.000058326,0.000059746,0.000061121,0.000063634,0.000060710,0.000064001,0.000088762,0.000093872},
{0.000092051,0.000089961,0.000064671,0.000060256,0.000063702,0.000060022,0.000058830,0.000058471,0.000056187,0.000055920,0.000056371,0.000056151,0.000055486,0.000056371,0.000055819,0.000056061,0.000058455,0.000059053,0.000060820,0.000063608,0.000060404,0.000064592,0.000088213,0.000092383},
{0.000094503,0.000088789,0.000064938,0.000060152,0.000063596,0.000060065,0.000058868,0.000057574,0.000056526,0.000055224,0.000056850,0.000055708,0.000055812,0.000055300,0.000055363,0.000056369,0.000057674,0.000058786,0.000060327,0.000064925,0.000059715,0.000064487,0.000088023,0.000092915},
{0.000091884,0.000087829,0.000064524,0.000060502,0.000063951,0.000060595,0.000059026,0.000058321,0.000055742,0.000055849,0.000065127,0.000055998,0.000056541,0.000055918,0.000055983,0.000056351,0.000057704,0.000059458,0.000061382,0.000063682,0.000059858,0.000064304,0.000088452,0.000093440},
{0.000094635,0.000089193,0.000064480,0.000059863,0.000063777,0.000061031,0.000059089,0.000058422,0.000056111,0.000055274,0.000058801,0.000056008,0.000055804,0.000064463,0.000055746,0.000056346,0.000058405,0.000059016,0.000060737,0.000063118,0.000060503,0.000063629,0.000088914,0.000094458},
{0.000092984,0.000087367,0.000064129,0.000060358,0.000063444,0.000061010,0.000058796,0.000057796,0.000055837,0.000055604,0.000056122,0.000055881,0.000056466,0.000064221,0.000055378,0.000055554,0.000058292,0.000059374,0.000061235,0.000063286,0.000060584,0.000064208,0.000089445,0.000092198},
{0.000093410,0.000090165,0.000064369,0.000060581,0.000064754,0.000060840,0.000059079,0.000057806,0.000056629,0.000055231,0.000055626,0.000055611,0.000056277,0.000056054,0.000055696,0.000055959,0.000057534,0.000059375,0.000060875,0.000064051,0.000060600,0.000065185,0.000090197,0.000092305},
{0.000092951,0.000089684,0.000065060,0.000060192,0.000063226,0.000060911,0.000059121,0.000058183,0.000056123,0.000055300,0.000055318,0.000055593,0.000056151,0.000055571,0.000055849,0.000056239,0.000058445,0.000059039,0.000061220,0.000063110,0.000060861,0.000064883,0.000088872,0.000093126},
{0.000093221,0.000090580,0.000063956,0.000060185,0.000064210,0.000061402,0.000059086,0.000058511,0.000056197,0.000055215,0.000055952,0.000056225,0.000056199,0.000056145,0.000055393,0.000056357,0.000058458,0.000059947,0.000060960,0.000063178,0.000060418,0.000064427,0.000089757,0.000093307}};

//==========================================================================================================================

const double rochcor2016::dd[12]={0.00164135,0.00428143,0.00878218,0.00884017,0.0150786,0.0195104,0.0179773,0.0406446,0.0220819,0.0329138,0.0297842,0.0092185};
const double rochcor2016::md[12]={0.000141451,0.00295811,0.00151669,0.000608238,0.00354278,0.00655419,0.00473961,0.00488091,0.00720306,0.0118497,0.0232649,0.032047};
const double rochcor2016::dder[12]={0.00153697,0.00130005,0.00179734,0.00216179,0.00262681,0.00343007,0.00431843,0.0047659,0.00559818,0.00747678,0.0133283,0.0164953};
const double rochcor2016::mder[12]={0.000905685,0.0010009,0.00135474,0.00163635,0.00208254,0.00294481,0.00337202,0.00327339,0.00366122,0.00462714,0.00746907,0.0117806};

const double rochcor2016::dscl[24]={0.999651,0.998845,0.999199,0.999164,0.999613,0.999815,1.00006,1.0002,1.00026,1.00039,1.00039,1.00036,1,1.00053,1.00033,1.00051,1.00027,1.00016,0.999876,0.99991,0.999376,0.999428,0.998933,0.999343};
const double rochcor2016::mscl[24]={1.00021,1.00022,1.00019,1,1.00025,0.999995,1.00002,1.00017,0.999988,1.00008,1.00001,1.00039,1.00008,1.00016,1.00028,1.00036,1.00038,1.00011,1.00003,1.00004,0.999813,1.00031,1.00013,1.0003};

RocRes muresol1;

//===============================================================================================

rochcor2016::~rochcor2016(){
}

rochcor2016::rochcor2016(std::string initfile){

  muresol1.init(initfile);
  //muresol1.dumpParams();
  
  eran.SetSeed(123456);
  sran.SetSeed(1234);
  
  gscler_mc_dev=0;
  gscler_da_dev=0;

  for(int i=0; i<16; ++i){
      for(int j=0; j<24; ++j){
          mptsys_mc_dm[i][j]=0;
          mptsys_mc_da[i][j]=0;
          mptsys_da_dm[i][j]=0;
          mptsys_da_da[i][j]=0;
      }
  }

}

rochcor2016::rochcor2016(std::string initfile, int seed){

  muresol1.init(initfile);
  muresol1.dumpParams();

  eran.SetSeed(123456);
  sran.SetSeed(seed);

  gscler_mc_dev=sran.Gaus(0.0, 1.0);
  gscler_da_dev=sran.Gaus(0.0, 1.0);

  for(int i=0; i<16; ++i){
      for(int j=0; j<24; ++j){
          mptsys_mc_dm[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_mc_da[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_da_dm[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_da_da[i][j]=sran.Gaus(0.0, 1.0);
      }
  }
}

void rochcor2016::momcor_mc( TLorentzVector& mu, float charge, int ntrk, float& qter){
  
  //sysdev == num : deviation = num
  double mupt_bfcor = mu.Pt();
  double mupt = mu.Pt();
  double muphi = mu.Phi();
  double mueta = mu.Eta(); // same with mu.Eta() in Root

  double px = mu.Px();
  double py = mu.Py();
  double pz = mu.Pz();
  double e = mu.E();

  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  int mu_aetabin = aetabin(mueta);
  
  if(mu_phibin>=0 && mu_etabin>=0){
    
    double Mf = (mcor_bf[mu_phibin][mu_etabin] + mptsys_mc_dm[mu_phibin][mu_etabin]*mcor_bfer[mu_phibin][mu_etabin])/(mpavg[mu_phibin][mu_etabin]+mmavg[mu_phibin][mu_etabin]);
    double Af = ((mcor_ma[mu_phibin][mu_etabin]+mptsys_mc_da[mu_phibin][mu_etabin]*mcor_maer[mu_phibin][mu_etabin]) - Mf*(mpavg[mu_phibin][mu_etabin]-mmavg[mu_phibin][mu_etabin]));     
    
    double cor = 1.0/(1.0 + 2.0*Mf + charge*Af*mupt);
    
    //for the momentum tuning - eta,phi,Q correction
    mupt *= cor;
    
    double gscl = (mgscl);
    double gscler = mgscl_stat;    
    //double tune = muresol1.kSmear(mupt,mueta,ntrk,muresolution::Extra);
    double u = eran.Rndm();
    double w = eran.Rndm();
    double tune = muresol1.kExtraDet(mupt,mueta,ntrk,u,w);
    //double tune = 1.0;

    mupt *= (gscl + gscler_mc_dev*gscler)*(tune*mscl[mu_etabin]);    
    
    //dE/dx correction for low pt is not available in rereco version yet
    double pt_tune = (mupt-md[mu_aetabin])*45.0/(45.0-md[mu_aetabin]);
    mupt = pt_tune;
    
    double momscl = mupt_bfcor/mupt;
    qter *= sqrt(momscl*momscl + (1.0-tune)*(1.0-tune));
    
  }
  
  mu.SetPtEtaPhiM(mupt,mueta,muphi,mu_mass);
}


void rochcor2016::momcor_data( TLorentzVector& mu, float charge, int runopt, float& qter){
  
  double mupt_bfcor = mu.Pt();
  double mupt = mu.Pt();
  
  double muphi = mu.Phi();
  double mueta = mu.Eta(); // same with mu.Eta() in Root
  
  double px = mu.Px();
  double py = mu.Py();
  double pz = mu.Pz();
  double e = mu.E();
  
  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  int mu_aetabin = aetabin(mueta);

  if(mu_phibin>=0 && mu_etabin>=0){
    
    double Mf = (dcor_bf[mu_phibin][mu_etabin]+mptsys_da_dm[mu_phibin][mu_etabin]*dcor_bfer[mu_phibin][mu_etabin])/(dpavg[mu_phibin][mu_etabin]+dmavg[mu_phibin][mu_etabin]);
    double Af = ((dcor_ma[mu_phibin][mu_etabin]+mptsys_da_da[mu_phibin][mu_etabin]*dcor_maer[mu_phibin][mu_etabin]) - Mf*(dpavg[mu_phibin][mu_etabin]-dmavg[mu_phibin][mu_etabin]));     
    
    double cor = 1.0/(1.0 + 2.0*Mf + charge*Af*mupt);
    
    mupt *= cor;  
    
    //after Z pt correction
    double gscl = (dgscl);
    double gscler = dgscl_stat;

    mupt *= (gscl + gscler_da_dev*gscler)*dscl[mu_etabin];
    
    //dE/dx correction for low pt is not available in rereco version yet
    double pt_tune = (mupt-dd[mu_aetabin])*45.0/(45.0-dd[mu_aetabin]);
    mupt = pt_tune; 
    
    double momscl = mupt_bfcor/mupt;
    qter *= momscl;
    
  }
  
  mu.SetPtEtaPhiM(mupt,mueta,muphi,mu_mass);
  
}

Int_t rochcor2016::phibin(double phi){
  
  int nphibin = -1;
  
  for(int i=0; i<16; i++){
    if(-pi+(2.0*pi/16.0)*i <= phi && -pi+(2.0*pi/16.0)*(i+1) > phi){
      nphibin = i;
      break;
    }
  }
  
  return nphibin;
}

Int_t rochcor2016::etabin(double eta){
  
  int nbin = -1;
  
  for(int i=0; i<24; i++){
    if(netabin[i] <= eta && netabin[i+1] > eta){
      nbin = i;
      break;
    }
  }
  
  return nbin;
}



Int_t rochcor2016::aetabin(double eta){
  
  int nbin = -1;
  
  for(int i=0; i<12; i++){
    if(anetabin[i] <= fabs(eta) && anetabin[i+1] > fabs(eta)){
      nbin = i;
      break;
    }
  }
  
  return nbin;
}

